Sun Sep 22 02:39:36 EDT 2024
/home/m.maqboolbhutta/usman_ws/codes/openibl4
/home/m.maqboolbhutta/.conda/envs/openibl4/bin/python
Host: c0904a-s35
Other nodes: 
/home/m.maqboolbhutta/usman_ws/models/openibl/0921-try4-fusion-new-sfrs/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-22-Sep
==========Starting Training=============
========================================
Use GPU: 2 for training, rank no.2 of world_size 4
Use GPU: 0 for training, rank no.0 of world_size 4
Use GPU: 3 for training, rank no.3 of world_size 4
Use GPU: 1 for training, rank no.1 of world_size 4
==========
Args:Namespace(arch='vgg16', cache_size=1000, data_dir='/home/m.maqboolbhutta/usman_ws/codes/OpenIBL/examples/data/', dataset='pitts', deterministic=False, epochs=5, eval_step=1, fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, generations=4, gpu=0, height=480, init_dir='/blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init', iters=0, launcher='slurm', layers='conv5', logs_dir='/home/m.maqboolbhutta/usman_ws/models/openibl/0921-try4-fusion-new-sfrs/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-22-Sep', loss_type='sare_ind', lr=0.001, margin=0.1, method='graphvlad', momentum=0.9, neg_num=10, neg_pool=1000, ngpus_per_node=4, nowhiten=False, num_clusters=64, pos_num=10, pos_pool=20, print_freq=500, rank=0, resume='', scale='30k', seed=43, soft_weight=0.5, step_size=5, sync_gather=False, syncbn=True, tcp_port='6010', temperature=[0.07, 0.07, 0.06, 0.05], test_batch_size=16, total_gpus=4, tuple_size=1, weight_decay=0.001, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init/vgg16_pitts_64_desc_cen.hdf5
===> Loading segmentation model
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init/vgg16_pitts_64_desc_cen.hdf5
===> Loading segmentation model
Test the initial model:
Extract Features: [100/276]	Time 0.193 (0.265)	Data 0.003 (0.054)	
Extract Features: [200/276]	Time 0.196 (0.235)	Data 0.001 (0.028)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          83.8%
  top-5          94.1%
  top-10         96.3%
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.181 (0.248)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.192 (0.223)	Data 0.001 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
