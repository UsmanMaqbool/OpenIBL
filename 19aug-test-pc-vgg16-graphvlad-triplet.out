==========Testing=============
/home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//model_best.pth.tar /home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//checkpoint0.pth.tar
==============================
==========################=============
 Testing /home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//model_best.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(arch='vgg16', data_dir='/home/leo/usman_ws/codes/OpenIBL/examples/data', dataset='pitts', fast_scnn='/home/leo/usman_ws/datasets/official/fast-scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/home/leo/usman_ws/codes/OpenIBL/examples/logs', method='graphvlad', ngpus_per_node=1, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//model_best.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
=> Loaded checkpoint '/home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//model_best.pth.tar'
=> Start epoch 0  best recall5 94.3%
PCA parameters path:  /home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug/pca_params_model_best.h5
Extract Features: [100/542]	Time 0.374 (0.432)	Data 0.000 (0.020)	
Extract Features: [200/542]	Time 0.375 (0.408)	Data 0.000 (0.010)	
Extract Features: [300/542]	Time 0.404 (0.404)	Data 0.000 (0.007)	
Extract Features: [400/542]	Time 0.408 (0.405)	Data 0.000 (0.005)	
Extract Features: [500/542]	Time 0.399 (0.405)	Data 0.000 (0.004)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
Extract Features: [100/259]	Time 0.403 (0.428)	Data 0.000 (0.021)	
Extract Features: [200/259]	Time 0.405 (0.416)	Data 0.000 (0.011)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [100/2624]	Time 0.417 (0.428)	Data 0.000 (0.022)	
Extract Features: [200/2624]	Time 0.405 (0.419)	Data 0.000 (0.011)	
Extract Features: [300/2624]	Time 0.402 (0.416)	Data 0.000 (0.008)	
Extract Features: [400/2624]	Time 0.406 (0.414)	Data 0.000 (0.006)	
Extract Features: [500/2624]	Time 0.402 (0.413)	Data 0.000 (0.005)	
Extract Features: [600/2624]	Time 0.373 (0.411)	Data 0.000 (0.004)	
Extract Features: [700/2624]	Time 0.372 (0.406)	Data 0.000 (0.003)	
Extract Features: [800/2624]	Time 0.376 (0.402)	Data 0.000 (0.003)	
Extract Features: [900/2624]	Time 0.375 (0.399)	Data 0.000 (0.003)	
Extract Features: [1000/2624]	Time 0.412 (0.397)	Data 0.000 (0.002)	
Extract Features: [1100/2624]	Time 0.420 (0.398)	Data 0.000 (0.002)	
Extract Features: [1200/2624]	Time 0.409 (0.399)	Data 0.000 (0.002)	
Extract Features: [1300/2624]	Time 0.411 (0.399)	Data 0.000 (0.002)	
Extract Features: [1400/2624]	Time 0.407 (0.400)	Data 0.000 (0.002)	
Extract Features: [1500/2624]	Time 0.409 (0.401)	Data 0.000 (0.002)	
Extract Features: [1600/2624]	Time 0.410 (0.401)	Data 0.000 (0.002)	
Extract Features: [1700/2624]	Time 0.404 (0.401)	Data 0.000 (0.001)	
Extract Features: [1800/2624]	Time 0.410 (0.402)	Data 0.000 (0.001)	
Extract Features: [1900/2624]	Time 0.405 (0.402)	Data 0.000 (0.001)	
Extract Features: [2000/2624]	Time 0.409 (0.402)	Data 0.000 (0.001)	
Extract Features: [2100/2624]	Time 0.409 (0.403)	Data 0.000 (0.001)	
Extract Features: [2200/2624]	Time 0.403 (0.403)	Data 0.000 (0.001)	
Extract Features: [2300/2624]	Time 0.405 (0.403)	Data 0.000 (0.001)	
Extract Features: [2400/2624]	Time 0.403 (0.403)	Data 0.000 (0.001)	
Extract Features: [2500/2624]	Time 0.405 (0.403)	Data 0.000 (0.001)	
Extract Features: [2600/2624]	Time 0.408 (0.404)	Data 0.000 (0.001)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.5%
  top-5          95.3%
  top-10         96.5%
Evaluate on the test set:
==========Test on Pitts30k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
load PCA parameters...
Extract Features: [100/213]	Time 0.412 (0.431)	Data 0.000 (0.021)	
Extract Features: [200/213]	Time 0.420 (0.421)	Data 0.000 (0.011)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [100/313]	Time 0.409 (0.429)	Data 0.000 (0.022)	
Extract Features: [200/313]	Time 0.404 (0.420)	Data 0.000 (0.011)	
Extract Features: [300/313]	Time 0.404 (0.415)	Data 0.000 (0.007)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.1%
  top-5          94.0%
  top-10         95.4%
==========Test on Tokyo247=============
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
load PCA parameters...
Extract Features: [100/315]	Time 0.139 (0.092)	Data 0.105 (0.048)	
Extract Features: [200/315]	Time 0.146 (0.077)	Data 0.112 (0.038)	
Extract Features: [300/315]	Time 0.043 (0.082)	Data 0.000 (0.038)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [100/2375]	Time 0.403 (0.427)	Data 0.000 (0.024)	
Extract Features: [200/2375]	Time 0.406 (0.416)	Data 0.000 (0.012)	
Extract Features: [300/2375]	Time 0.402 (0.412)	Data 0.000 (0.008)	
Extract Features: [400/2375]	Time 0.402 (0.409)	Data 0.000 (0.006)	
Extract Features: [500/2375]	Time 0.403 (0.408)	Data 0.000 (0.005)	
Extract Features: [600/2375]	Time 0.404 (0.408)	Data 0.000 (0.004)	
Extract Features: [700/2375]	Time 0.402 (0.408)	Data 0.000 (0.004)	
Extract Features: [800/2375]	Time 0.406 (0.407)	Data 0.000 (0.003)	
Extract Features: [900/2375]	Time 0.397 (0.406)	Data 0.000 (0.003)	
Extract Features: [1000/2375]	Time 0.397 (0.406)	Data 0.000 (0.003)	
Extract Features: [1100/2375]	Time 0.400 (0.405)	Data 0.000 (0.002)	
Extract Features: [1200/2375]	Time 0.403 (0.405)	Data 0.000 (0.002)	
Extract Features: [1300/2375]	Time 0.403 (0.405)	Data 0.000 (0.002)	
Extract Features: [1400/2375]	Time 0.404 (0.405)	Data 0.000 (0.002)	
Extract Features: [1500/2375]	Time 0.403 (0.404)	Data 0.000 (0.002)	
Extract Features: [1600/2375]	Time 0.404 (0.404)	Data 0.000 (0.002)	
Extract Features: [1700/2375]	Time 0.403 (0.404)	Data 0.000 (0.002)	
Extract Features: [1800/2375]	Time 0.399 (0.404)	Data 0.000 (0.001)	
Extract Features: [1900/2375]	Time 0.400 (0.404)	Data 0.000 (0.001)	
Extract Features: [2000/2375]	Time 0.405 (0.404)	Data 0.000 (0.001)	
Extract Features: [2100/2375]	Time 0.402 (0.404)	Data 0.000 (0.001)	
Extract Features: [2200/2375]	Time 0.404 (0.404)	Data 0.000 (0.001)	
Extract Features: [2300/2375]	Time 0.411 (0.404)	Data 0.000 (0.001)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          78.4%
  top-5          86.3%
  top-10         88.6%
==========################=============
 Done Testing with /home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//model_best.pth.tar file...
=======================================
==========################=============
 Testing /home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//checkpoint0.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(arch='vgg16', data_dir='/home/leo/usman_ws/codes/OpenIBL/examples/data', dataset='pitts', fast_scnn='/home/leo/usman_ws/datasets/official/fast-scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/home/leo/usman_ws/codes/OpenIBL/examples/logs', method='graphvlad', ngpus_per_node=1, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//checkpoint0.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
=> Loaded checkpoint '/home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug//checkpoint0.pth.tar'
=> Start epoch 0  best recall5 94.3%
PCA parameters path:  /home/leo/usman_ws/models/openibl/fastscnn_v4_16Aug/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple1-19-Aug/pca_params_checkpoint0.h5
