/tmp/slurmd/job39235170/slurm_script: line 88: ===================================================================================================: command not found
/tmp/slurmd/job39235170/slurm_script: line 90: ===================================================================================================: command not found
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x1530cc573dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 3869555) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3781647) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_10:05:02
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3781648)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_10:05:02
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3781649)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_10:05:02
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3781650)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_10:05:02
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3781647)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
      File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3870156 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3870158 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 1 (pid: 3870157) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_10:27:30
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3870159)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_10:27:30
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3870157)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3959259 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 3959261 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3959258) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_10:50:18
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3959260)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_10:50:18
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3959258)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x14ba76949dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 4134039) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4049713) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_11:12:52
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4049714)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_11:12:52
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4049715)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_11:12:52
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4049716)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_11:12:52
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4049713)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 4134888) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_11:35:15
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 4134889)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_11:35:15
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 4134890)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_11:35:15
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 4134891)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_11:35:15
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 4134888)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 30068 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 30069 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 30066) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_11:57:48
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 30067)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_11:57:48
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 30066)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 119849) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_12:20:17
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 119850)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_12:20:17
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 119851)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_12:20:17
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 119852)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_12:20:17
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 119849)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 207338) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_12:43:05
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 207340)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_12:43:05
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 207341)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_12:43:05
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 207342)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_12:43:05
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 207338)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x152b5a8f1dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 382588) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x14bb46278dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 382605) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 295043 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 295042) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_13:05:27
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 295044)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_13:05:27
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 295045)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_13:05:27
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 295042)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 383305) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_13:28:01
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 383306)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_13:28:01
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 383307)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_13:28:01
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 383308)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_13:28:01
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 383305)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x1542219fadc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 558298) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 472339) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_13:50:23
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 472340)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_13:50:23
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 472341)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_13:50:23
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 472342)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_13:50:23
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 472339)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x150bc569bdc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 646450) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 558950) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_14:13:01
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 558951)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_14:13:01
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 558953)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_14:13:01
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 558954)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_14:13:01
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 558950)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 647150) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_14:35:34
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 647151)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_14:35:34
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 647152)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_14:35:34
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 647153)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_14:35:34
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 647150)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x14e3d04e1dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 47, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 27, in poll
    pid, sts = os.waitpid(self.pid, flag)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 824328) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 735035 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 735032) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_14:58:12
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 735033)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_14:58:12
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 735034)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_14:58:12
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 735032)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x153bb5e0ddc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 915086) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x14cb05597dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
      File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 915091) is killed by signal: Aborted. 
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 825048) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_15:20:45
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 825049)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_15:20:45
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 825050)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_15:20:45
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 825051)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_15:20:45
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 825048)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 915686) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_15:43:14
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 915687)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_15:43:14
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 915688)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_15:43:14
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 915689)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_15:43:14
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 915686)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1000721) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-30_15:55:51
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1000722)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-30_15:55:51
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1000723)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-30_15:55:51
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1000724)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-30_15:55:51
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1000721)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x14a5efb18dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1816118) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x14f01715ddc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 1816109) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1728626) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_13:38:24
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1728627)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_13:38:24
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1728628)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_13:38:24
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1728629)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_13:38:24
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1728626)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1816732 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1816734 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1816731) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_14:01:02
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1816733)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_14:01:02
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1816731)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1906858) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_14:23:41
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 1906859)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_14:23:41
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1906860)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_14:23:41
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1906861)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_14:23:41
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1906858)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x14d5fd5a2dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 2085379) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1995964 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 1995963) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_14:46:14
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 1995967)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_14:46:14
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 1995972)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_14:46:14
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 1995963)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2085994) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_15:08:42
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2085995)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_15:08:42
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2085996)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_15:08:42
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2085997)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_15:08:42
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2085994)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2175585) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_15:31:15
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2175586)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_15:31:15
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2175587)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_15:31:15
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2175588)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_15:31:15
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2175585)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2261697) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_15:53:38
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2261698)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_15:53:38
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2261699)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_15:53:38
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2261700)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_15:53:38
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2261697)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x15200773bdc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 2438576) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2349891) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_16:16:26
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2349892)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_16:16:26
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2349893)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_16:16:26
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2349894)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_16:16:26
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2349891)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x148772153dc0>
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1466, in __del__
    self._shutdown_workers()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1430, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 2527071) is killed by signal: Aborted. 
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2439444 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2439445 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 2 (pid: 2439446) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_16:38:58
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2439447)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_16:38:58
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2439446)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2527682) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_17:01:27
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2527683)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_17:01:27
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2527684)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_17:01:27
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2527685)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_17:01:27
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2527682)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2614023) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_17:24:00
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2614032)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_17:24:00
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2614043)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_17:24:00
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2614054)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_17:24:00
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2614023)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2703898) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_17:46:33
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2703908)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_17:46:33
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2703919)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_17:46:33
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2703931)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_17:46:33
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2703898)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2790095 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2790096 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 2790098 closing signal SIGTERM
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 2 (pid: 2790097) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_18:09:30
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2790097)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2878828) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_18:32:00
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2878829)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_18:32:00
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2878830)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_18:32:00
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2878831)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_18:32:00
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2878828)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2969848) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_18:54:47
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2969849)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_18:54:47
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2969850)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_18:54:47
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2969851)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_18:54:47
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2969848)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
terminate called without an active exception
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3056423) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_19:17:25
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3056424)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_19:17:25
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3056425)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_19:17:25
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3056426)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_19:17:25
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3056423)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py:180: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
terminate called without an active exception
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 3
Traceback (most recent call last):
  File "examples/test_pitts_tokyo.py", line 224, in <module>
    main()
  File "examples/test_pitts_tokyo.py", line 84, in main
    main_worker(args)
  File "examples/test_pitts_tokyo.py", line 174, in main_worker
    evaluator.evaluate(test_loader_q, sorted(list(set(dataset.q_test) | set(dataset.db_test))),
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 181, in evaluate
    features = extract_features(self.model, query_loader, query,
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 55, in extract_features
    outputs = extract_cnn_feature(model, imgs, vlad, gpu=gpu)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/evaluators.py", line 25, in extract_cnn_feature
    outputs = model(inputs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1040, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1000, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 516, in forward
    pool_x, x_size, x_nodes = self.SelectRegions(x, self.base_model, self.fastscnn)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/netvlad.py", line 430, in forward
    outputs = fastscnn(x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 37, in forward
    x = self.feature_fusion(higher_res_features, x)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/blue/hmedeiros/m.maqboolbhutta/codes/OpenIBL/examples/ibl/models/fast_scnn.py", line 213, in forward
    out = higher_res_feature + lower_res_feature
RuntimeError: The size of tensor a (107) must match the size of tensor b (108) at non-singleton dimension 2
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 3147263) of binary: /home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Traceback (most recent call last):
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/run.py", line 753, in run
    elastic_launch(
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torch/distributed/launcher/api.py", line 246, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
examples/test_pitts_tokyo.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-07-31_19:30:07
  host      : c0901a-s29.ufhpc
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 3147264)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-07-31_19:30:07
  host      : c0901a-s29.ufhpc
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 3147266)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-07-31_19:30:07
  host      : c0901a-s29.ufhpc
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 3147267)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-07-31_19:30:07
  host      : c0901a-s29.ufhpc
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 3147263)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/m.maqboolbhutta/.conda/envs/openibl/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
slurmstepd: error: *** STEP 39235170.2 ON c0901a-s29 CANCELLED AT 2024-08-01T08:18:52 ***
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 39235170 ON c0901a-s29 CANCELLED AT 2024-08-01T08:18:52 ***
