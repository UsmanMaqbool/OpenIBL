Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint0_4.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint0_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint0_4.pth.tar'
=> Start epoch 4  best recall5 92.3%
Extract Features: [200/542]	Time 0.756 (0.732)	Data 0.547 (0.500)	
Extract Features: [400/542]	Time 1.132 (0.699)	Data 0.923 (0.478)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.216 (0.653)	Data 0.000 (0.436)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.471 (0.763)	Data 0.255 (0.548)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          84.8%
  top-5          92.3%
  top-10         94.0%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint0_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint0_4.pth.tar'
=> Start epoch 4  best recall5 92.3%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.050)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 1.534 (1.132)	Data 1.319 (0.907)	
Extract Features: [400/2375]	Time 1.926 (1.127)	Data 1.710 (0.907)	
Extract Features: [600/2375]	Time 2.015 (1.127)	Data 1.800 (0.908)	
Extract Features: [800/2375]	Time 1.633 (1.121)	Data 1.417 (0.903)	
Extract Features: [1000/2375]	Time 1.987 (1.119)	Data 1.772 (0.902)	
Extract Features: [1200/2375]	Time 2.225 (1.124)	Data 2.010 (0.907)	
Extract Features: [1400/2375]	Time 2.049 (1.124)	Data 1.833 (0.907)	
Extract Features: [1600/2375]	Time 2.487 (1.126)	Data 2.272 (0.909)	
Extract Features: [1800/2375]	Time 2.427 (1.127)	Data 2.212 (0.911)	
Extract Features: [2000/2375]	Time 2.106 (1.127)	Data 1.892 (0.911)	
Extract Features: [2200/2375]	Time 2.117 (1.128)	Data 1.901 (0.912)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          76.2%
  top-5          81.9%
  top-10         84.1%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_0.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_0.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_0.pth.tar'
=> Start epoch 0  best recall5 94.4%
Extract Features: [200/542]	Time 1.035 (0.747)	Data 0.825 (0.513)	
Extract Features: [400/542]	Time 1.144 (0.716)	Data 0.935 (0.494)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.774 (0.586)	Data 0.559 (0.369)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.809 (0.769)	Data 0.594 (0.554)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.3%
  top-5          93.2%
  top-10         94.7%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_0.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_0.pth.tar'
=> Start epoch 0  best recall5 94.4%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.048)	Data 0.000 (0.018)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 1.261 (1.124)	Data 1.046 (0.900)	
Extract Features: [400/2375]	Time 1.921 (1.124)	Data 1.705 (0.904)	
Extract Features: [600/2375]	Time 2.121 (1.123)	Data 1.905 (0.905)	
Extract Features: [800/2375]	Time 1.659 (1.118)	Data 1.444 (0.900)	
Extract Features: [1000/2375]	Time 1.999 (1.119)	Data 1.785 (0.901)	
Extract Features: [1200/2375]	Time 2.087 (1.123)	Data 1.872 (0.906)	
Extract Features: [1400/2375]	Time 2.054 (1.123)	Data 1.839 (0.906)	
Extract Features: [1600/2375]	Time 2.516 (1.125)	Data 2.301 (0.908)	
Extract Features: [1800/2375]	Time 2.504 (1.128)	Data 2.290 (0.911)	
Extract Features: [2000/2375]	Time 2.107 (1.128)	Data 1.892 (0.912)	
Extract Features: [2200/2375]	Time 2.189 (1.129)	Data 1.974 (0.913)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          77.5%
  top-5          85.1%
  top-10         89.8%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_1.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_1.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_1.pth.tar'
=> Start epoch 1  best recall5 95.3%
Extract Features: [200/542]	Time 0.406 (0.752)	Data 0.197 (0.518)	
Extract Features: [400/542]	Time 1.132 (0.717)	Data 0.922 (0.496)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.338 (0.571)	Data 0.122 (0.355)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.109 (0.758)	Data 0.895 (0.543)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.6%
  top-5          93.3%
  top-10         94.9%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_1.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_1.pth.tar'
=> Start epoch 1  best recall5 95.3%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.047)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.262 (1.136)	Data 0.047 (0.912)	
Extract Features: [400/2375]	Time 0.928 (1.122)	Data 0.714 (0.902)	
Extract Features: [600/2375]	Time 1.017 (1.113)	Data 0.801 (0.895)	
Extract Features: [800/2375]	Time 1.250 (1.105)	Data 1.036 (0.888)	
Extract Features: [1000/2375]	Time 1.123 (1.102)	Data 0.909 (0.885)	
Extract Features: [1200/2375]	Time 0.878 (1.105)	Data 0.663 (0.889)	
Extract Features: [1400/2375]	Time 0.951 (1.101)	Data 0.737 (0.885)	
Extract Features: [1600/2375]	Time 0.914 (1.101)	Data 0.700 (0.886)	
Extract Features: [1800/2375]	Time 0.927 (1.102)	Data 0.713 (0.886)	
Extract Features: [2000/2375]	Time 0.758 (1.100)	Data 0.544 (0.884)	
Extract Features: [2200/2375]	Time 0.493 (1.099)	Data 0.278 (0.883)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.7%
  top-5          88.9%
  top-10         91.7%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_2.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_2.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_2.pth.tar'
=> Start epoch 2  best recall5 95.8%
Extract Features: [200/542]	Time 0.304 (0.735)	Data 0.095 (0.501)	
Extract Features: [400/542]	Time 0.209 (0.704)	Data 0.000 (0.483)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.269 (0.574)	Data 0.053 (0.358)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.157 (0.752)	Data 0.943 (0.537)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.7%
  top-5          93.6%
  top-10         95.2%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_2.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_2.pth.tar'
=> Start epoch 2  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.047)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.215 (1.137)	Data 0.000 (0.914)	
Extract Features: [400/2375]	Time 0.215 (1.131)	Data 0.000 (0.912)	
Extract Features: [600/2375]	Time 0.215 (1.128)	Data 0.000 (0.910)	
Extract Features: [800/2375]	Time 0.215 (1.124)	Data 0.000 (0.907)	
Extract Features: [1000/2375]	Time 0.215 (1.123)	Data 0.000 (0.906)	
Extract Features: [1200/2375]	Time 0.215 (1.127)	Data 0.000 (0.911)	
Extract Features: [1400/2375]	Time 0.215 (1.126)	Data 0.000 (0.910)	
Extract Features: [1600/2375]	Time 0.215 (1.128)	Data 0.000 (0.912)	
Extract Features: [1800/2375]	Time 0.214 (1.130)	Data 0.000 (0.914)	
Extract Features: [2000/2375]	Time 0.226 (1.129)	Data 0.000 (0.913)	
Extract Features: [2200/2375]	Time 0.215 (1.130)	Data 0.000 (0.914)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          80.3%
  top-5          87.3%
  top-10         90.8%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_3.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_3.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_3.pth.tar'
=> Start epoch 3  best recall5 95.8%
Extract Features: [200/542]	Time 1.136 (0.759)	Data 0.926 (0.518)	
Extract Features: [400/542]	Time 0.210 (0.718)	Data 0.000 (0.493)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.728 (0.578)	Data 0.513 (0.362)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.391 (0.750)	Data 0.176 (0.535)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.2%
  top-5          94.1%
  top-10         95.5%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_3.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_3.pth.tar'
=> Start epoch 3  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.031 (0.047)	Data 0.011 (0.018)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.214 (1.139)	Data 0.000 (0.915)	
Extract Features: [400/2375]	Time 0.215 (1.134)	Data 0.000 (0.914)	
Extract Features: [600/2375]	Time 0.215 (1.129)	Data 0.000 (0.911)	
Extract Features: [800/2375]	Time 0.215 (1.123)	Data 0.000 (0.906)	
Extract Features: [1000/2375]	Time 0.223 (1.122)	Data 0.000 (0.905)	
Extract Features: [1200/2375]	Time 0.215 (1.124)	Data 0.000 (0.908)	
Extract Features: [1400/2375]	Time 0.215 (1.124)	Data 0.000 (0.908)	
Extract Features: [1600/2375]	Time 0.215 (1.125)	Data 0.000 (0.909)	
Extract Features: [1800/2375]	Time 0.215 (1.127)	Data 0.000 (0.911)	
Extract Features: [2000/2375]	Time 0.215 (1.127)	Data 0.000 (0.911)	
Extract Features: [2200/2375]	Time 0.217 (1.128)	Data 0.000 (0.912)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          80.3%
  top-5          87.3%
  top-10         90.5%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_4.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_4.pth.tar'
=> Start epoch 4  best recall5 95.8%
Extract Features: [200/542]	Time 0.468 (0.740)	Data 0.260 (0.506)	
Extract Features: [400/542]	Time 0.865 (0.707)	Data 0.657 (0.485)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.464 (0.555)	Data 0.249 (0.339)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.214 (0.753)	Data 0.000 (0.538)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.7%
  top-5          93.6%
  top-10         95.2%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint1_4.pth.tar'
=> Start epoch 4  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.050)	Data 0.000 (0.020)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.414 (1.129)	Data 0.199 (0.905)	
Extract Features: [400/2375]	Time 0.305 (1.112)	Data 0.090 (0.893)	
Extract Features: [600/2375]	Time 0.215 (1.108)	Data 0.000 (0.891)	
Extract Features: [800/2375]	Time 0.215 (1.104)	Data 0.000 (0.887)	
Extract Features: [1000/2375]	Time 0.215 (1.104)	Data 0.000 (0.887)	
Extract Features: [1200/2375]	Time 0.215 (1.110)	Data 0.000 (0.894)	
Extract Features: [1400/2375]	Time 0.215 (1.109)	Data 0.000 (0.893)	
Extract Features: [1600/2375]	Time 0.215 (1.111)	Data 0.000 (0.895)	
Extract Features: [1800/2375]	Time 0.650 (1.110)	Data 0.435 (0.894)	
Extract Features: [2000/2375]	Time 0.900 (1.106)	Data 0.685 (0.890)	
Extract Features: [2200/2375]	Time 0.535 (1.104)	Data 0.321 (0.889)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          81.0%
  top-5          87.6%
  top-10         92.1%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_0.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_0.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_0.pth.tar'
=> Start epoch 0  best recall5 95.8%
Extract Features: [200/542]	Time 0.209 (0.746)	Data 0.000 (0.513)	
Extract Features: [400/542]	Time 0.259 (0.716)	Data 0.050 (0.495)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.215 (0.563)	Data 0.000 (0.347)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.108 (0.750)	Data 0.893 (0.536)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.1%
  top-5          93.1%
  top-10         94.9%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_0.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_0.pth.tar'
=> Start epoch 0  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.048)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 1.167 (1.124)	Data 0.953 (0.900)	
Extract Features: [400/2375]	Time 2.015 (1.121)	Data 1.800 (0.902)	
Extract Features: [600/2375]	Time 2.222 (1.122)	Data 2.007 (0.904)	
Extract Features: [800/2375]	Time 1.603 (1.117)	Data 1.388 (0.900)	
Extract Features: [1000/2375]	Time 2.058 (1.117)	Data 1.844 (0.900)	
Extract Features: [1200/2375]	Time 2.074 (1.122)	Data 1.860 (0.906)	
Extract Features: [1400/2375]	Time 2.068 (1.122)	Data 1.853 (0.906)	
Extract Features: [1600/2375]	Time 2.518 (1.125)	Data 2.303 (0.909)	
Extract Features: [1800/2375]	Time 2.477 (1.128)	Data 2.261 (0.912)	
Extract Features: [2000/2375]	Time 1.945 (1.128)	Data 1.730 (0.912)	
Extract Features: [2200/2375]	Time 2.075 (1.129)	Data 1.860 (0.914)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.0%
  top-5          86.7%
  top-10         89.2%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_1.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_1.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_1.pth.tar'
=> Start epoch 1  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.372 (0.676)	Data 0.155 (0.436)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.038 (0.748)	Data 0.823 (0.533)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.3%
  top-5          93.6%
  top-10         95.1%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_1.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_1.pth.tar'
=> Start epoch 1  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.051 (0.047)	Data 0.031 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 1.337 (1.127)	Data 1.123 (0.904)	
Extract Features: [400/2375]	Time 2.103 (1.127)	Data 1.888 (0.908)	
Extract Features: [600/2375]	Time 2.323 (1.129)	Data 2.108 (0.911)	
Extract Features: [800/2375]	Time 1.635 (1.126)	Data 1.421 (0.909)	
Extract Features: [1000/2375]	Time 2.048 (1.126)	Data 1.834 (0.909)	
Extract Features: [1200/2375]	Time 2.238 (1.131)	Data 2.024 (0.915)	
Extract Features: [1400/2375]	Time 2.148 (1.131)	Data 1.933 (0.915)	
Extract Features: [1600/2375]	Time 2.421 (1.133)	Data 2.207 (0.917)	
Extract Features: [1800/2375]	Time 2.437 (1.136)	Data 2.222 (0.920)	
Extract Features: [2000/2375]	Time 2.026 (1.137)	Data 1.811 (0.921)	
Extract Features: [2200/2375]	Time 2.152 (1.138)	Data 1.937 (0.923)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          76.5%
  top-5          85.7%
  top-10         88.6%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_2.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_2.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_2.pth.tar'
=> Start epoch 2  best recall5 95.8%
Extract Features: [200/542]	Time 1.046 (0.759)	Data 0.837 (0.525)	
Extract Features: [400/542]	Time 0.571 (0.721)	Data 0.363 (0.500)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.216 (0.627)	Data 0.000 (0.411)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.475 (0.767)	Data 0.260 (0.552)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.3%
  top-5          93.3%
  top-10         95.3%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_2.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_2.pth.tar'
=> Start epoch 2  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.047)	Data 0.000 (0.018)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.215 (1.134)	Data 0.000 (0.910)	
Extract Features: [400/2375]	Time 0.465 (1.120)	Data 0.251 (0.901)	
Extract Features: [600/2375]	Time 0.215 (1.114)	Data 0.000 (0.896)	
Extract Features: [800/2375]	Time 0.216 (1.106)	Data 0.000 (0.889)	
Extract Features: [1000/2375]	Time 0.275 (1.105)	Data 0.060 (0.888)	
Extract Features: [1200/2375]	Time 0.428 (1.112)	Data 0.212 (0.895)	
Extract Features: [1400/2375]	Time 0.267 (1.111)	Data 0.051 (0.894)	
Extract Features: [1600/2375]	Time 0.721 (1.112)	Data 0.505 (0.896)	
Extract Features: [1800/2375]	Time 0.858 (1.112)	Data 0.643 (0.896)	
Extract Features: [2000/2375]	Time 0.860 (1.111)	Data 0.645 (0.895)	
Extract Features: [2200/2375]	Time 1.056 (1.111)	Data 0.841 (0.895)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.7%
  top-5          88.9%
  top-10         91.1%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_3.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_3.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_3.pth.tar'
=> Start epoch 3  best recall5 95.8%
Extract Features: [200/542]	Time 0.971 (0.755)	Data 0.762 (0.521)	
Extract Features: [400/542]	Time 0.995 (0.717)	Data 0.785 (0.496)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.215 (0.599)	Data 0.000 (0.383)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.194 (0.766)	Data 0.980 (0.551)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.7%
  top-5          93.9%
  top-10         95.3%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_3.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_3.pth.tar'
=> Start epoch 3  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.052)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.743 (1.126)	Data 0.528 (0.901)	
Extract Features: [400/2375]	Time 0.302 (1.113)	Data 0.088 (0.894)	
Extract Features: [600/2375]	Time 0.629 (1.109)	Data 0.414 (0.891)	
Extract Features: [800/2375]	Time 0.739 (1.103)	Data 0.524 (0.886)	
Extract Features: [1000/2375]	Time 0.409 (1.101)	Data 0.195 (0.884)	
Extract Features: [1200/2375]	Time 0.494 (1.105)	Data 0.279 (0.889)	
Extract Features: [1400/2375]	Time 0.485 (1.102)	Data 0.271 (0.886)	
Extract Features: [1600/2375]	Time 0.855 (1.103)	Data 0.641 (0.887)	
Extract Features: [1800/2375]	Time 0.641 (1.104)	Data 0.426 (0.888)	
Extract Features: [2000/2375]	Time 0.735 (1.103)	Data 0.520 (0.887)	
Extract Features: [2200/2375]	Time 0.944 (1.103)	Data 0.729 (0.887)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          82.2%
  top-5          87.0%
  top-10         88.9%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_4.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_4.pth.tar'
=> Start epoch 4  best recall5 95.8%
Extract Features: [200/542]	Time 0.209 (0.742)	Data 0.000 (0.508)	
Extract Features: [400/542]	Time 0.209 (0.716)	Data 0.000 (0.495)	
gathering features from rank no.0
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.215 (0.584)	Data 0.000 (0.368)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.227 (0.771)	Data 1.012 (0.555)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.5%
  top-5          93.6%
  top-10         95.4%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint2_4.pth.tar'
=> Start epoch 4  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.048)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.278 (1.135)	Data 0.064 (0.910)	
Extract Features: [400/2375]	Time 1.011 (1.121)	Data 0.796 (0.901)	
Extract Features: [600/2375]	Time 0.747 (1.114)	Data 0.533 (0.895)	
Extract Features: [800/2375]	Time 0.214 (1.107)	Data 0.000 (0.889)	
Extract Features: [1000/2375]	Time 0.417 (1.106)	Data 0.202 (0.889)	
Extract Features: [1200/2375]	Time 0.493 (1.111)	Data 0.279 (0.894)	
Extract Features: [1400/2375]	Time 0.216 (1.109)	Data 0.000 (0.893)	
Extract Features: [1600/2375]	Time 0.760 (1.110)	Data 0.546 (0.894)	
Extract Features: [1800/2375]	Time 0.215 (1.110)	Data 0.000 (0.894)	
Extract Features: [2000/2375]	Time 0.214 (1.109)	Data 0.000 (0.893)	
Extract Features: [2200/2375]	Time 0.215 (1.111)	Data 0.000 (0.895)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          81.6%
  top-5          87.3%
  top-10         90.2%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_0.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_0.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_0.pth.tar'
=> Start epoch 0  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.309 (0.681)	Data 0.095 (0.441)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.633 (0.752)	Data 0.418 (0.537)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.5%
  top-5          93.5%
  top-10         95.0%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_0.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_0.pth.tar'
=> Start epoch 0  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.048)	Data 0.000 (0.020)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.743 (1.135)	Data 0.528 (0.910)	
Extract Features: [400/2375]	Time 0.469 (1.118)	Data 0.254 (0.899)	
Extract Features: [600/2375]	Time 0.309 (1.114)	Data 0.095 (0.896)	
Extract Features: [800/2375]	Time 0.215 (1.107)	Data 0.000 (0.890)	
Extract Features: [1000/2375]	Time 0.643 (1.106)	Data 0.428 (0.890)	
Extract Features: [1200/2375]	Time 0.957 (1.110)	Data 0.742 (0.893)	
Extract Features: [1400/2375]	Time 0.430 (1.106)	Data 0.215 (0.890)	
Extract Features: [1600/2375]	Time 1.101 (1.106)	Data 0.886 (0.890)	
Extract Features: [1800/2375]	Time 0.501 (1.107)	Data 0.286 (0.891)	
Extract Features: [2000/2375]	Time 1.014 (1.106)	Data 0.799 (0.890)	
Extract Features: [2200/2375]	Time 0.891 (1.105)	Data 0.676 (0.890)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.7%
  top-5          87.3%
  top-10         92.1%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_1.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_1.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_1.pth.tar'
=> Start epoch 1  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.419 (0.686)	Data 0.205 (0.445)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.474 (0.745)	Data 0.259 (0.530)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.9%
  top-5          93.9%
  top-10         95.3%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_1.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_1.pth.tar'
=> Start epoch 1  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.047)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.215 (1.143)	Data 0.000 (0.919)	
Extract Features: [400/2375]	Time 0.215 (1.133)	Data 0.000 (0.914)	
Extract Features: [600/2375]	Time 0.214 (1.130)	Data 0.000 (0.912)	
Extract Features: [800/2375]	Time 0.214 (1.126)	Data 0.000 (0.909)	
Extract Features: [1000/2375]	Time 0.215 (1.126)	Data 0.000 (0.909)	
Extract Features: [1200/2375]	Time 0.215 (1.128)	Data 0.000 (0.912)	
Extract Features: [1400/2375]	Time 0.214 (1.127)	Data 0.000 (0.911)	
Extract Features: [1600/2375]	Time 0.215 (1.128)	Data 0.000 (0.912)	
Extract Features: [1800/2375]	Time 0.215 (1.129)	Data 0.000 (0.914)	
Extract Features: [2000/2375]	Time 0.215 (1.128)	Data 0.000 (0.912)	
Extract Features: [2200/2375]	Time 0.215 (1.126)	Data 0.000 (0.911)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.0%
  top-5          89.2%
  top-10         90.2%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_2.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_2.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_2.pth.tar'
=> Start epoch 2  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.735 (0.681)	Data 0.520 (0.440)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.003 (0.740)	Data 0.789 (0.526)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.1%
  top-5          94.2%
  top-10         95.7%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_2.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_2.pth.tar'
=> Start epoch 2  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.062 (0.048)	Data 0.042 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.663 (1.129)	Data 0.448 (0.905)	
Extract Features: [400/2375]	Time 0.470 (1.116)	Data 0.256 (0.896)	
Extract Features: [600/2375]	Time 0.800 (1.110)	Data 0.585 (0.892)	
Extract Features: [800/2375]	Time 0.215 (1.104)	Data 0.000 (0.886)	
Extract Features: [1000/2375]	Time 0.403 (1.102)	Data 0.189 (0.885)	
Extract Features: [1200/2375]	Time 0.450 (1.107)	Data 0.235 (0.890)	
Extract Features: [1400/2375]	Time 0.654 (1.104)	Data 0.440 (0.888)	
Extract Features: [1600/2375]	Time 0.288 (1.104)	Data 0.073 (0.888)	
Extract Features: [1800/2375]	Time 0.904 (1.104)	Data 0.689 (0.888)	
Extract Features: [2000/2375]	Time 0.900 (1.103)	Data 0.685 (0.888)	
Extract Features: [2200/2375]	Time 1.527 (1.103)	Data 1.312 (0.887)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          80.3%
  top-5          86.7%
  top-10         90.2%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_3.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_3.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_3.pth.tar'
=> Start epoch 3  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.865 (0.687)	Data 0.649 (0.447)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.216 (0.751)	Data 0.000 (0.536)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.4%
  top-5          94.0%
  top-10         95.5%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_3.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_3.pth.tar'
=> Start epoch 3  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.047)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 1.110 (1.125)	Data 0.896 (0.901)	
Extract Features: [400/2375]	Time 2.045 (1.116)	Data 1.830 (0.897)	
Extract Features: [600/2375]	Time 2.308 (1.119)	Data 2.093 (0.902)	
Extract Features: [800/2375]	Time 1.582 (1.117)	Data 1.367 (0.900)	
Extract Features: [1000/2375]	Time 2.021 (1.117)	Data 1.807 (0.900)	
Extract Features: [1200/2375]	Time 2.023 (1.122)	Data 1.809 (0.906)	
Extract Features: [1400/2375]	Time 2.084 (1.122)	Data 1.869 (0.906)	
Extract Features: [1600/2375]	Time 2.543 (1.124)	Data 2.328 (0.908)	
Extract Features: [1800/2375]	Time 2.417 (1.127)	Data 2.203 (0.911)	
Extract Features: [2000/2375]	Time 2.012 (1.128)	Data 1.797 (0.912)	
Extract Features: [2200/2375]	Time 2.147 (1.129)	Data 1.933 (0.914)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          78.7%
  top-5          86.0%
  top-10         87.9%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_4.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_4.pth.tar'
=> Start epoch 4  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.671 (0.683)	Data 0.456 (0.443)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 0.215 (0.752)	Data 0.000 (0.537)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.8%
  top-5          93.7%
  top-10         95.3%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_4.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/checkpoint3_4.pth.tar'
=> Start epoch 4  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.051 (0.047)	Data 0.032 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 1.263 (1.128)	Data 1.049 (0.905)	
Extract Features: [400/2375]	Time 2.101 (1.121)	Data 1.887 (0.902)	
Extract Features: [600/2375]	Time 2.094 (1.120)	Data 1.880 (0.902)	
Extract Features: [800/2375]	Time 1.567 (1.116)	Data 1.353 (0.899)	
Extract Features: [1000/2375]	Time 1.994 (1.116)	Data 1.780 (0.899)	
Extract Features: [1200/2375]	Time 1.995 (1.122)	Data 1.780 (0.905)	
Extract Features: [1400/2375]	Time 2.075 (1.122)	Data 1.860 (0.906)	
Extract Features: [1600/2375]	Time 2.514 (1.124)	Data 2.299 (0.908)	
Extract Features: [1800/2375]	Time 2.351 (1.127)	Data 2.136 (0.911)	
Extract Features: [2000/2375]	Time 2.065 (1.129)	Data 1.849 (0.913)	
Extract Features: [2200/2375]	Time 2.151 (1.130)	Data 1.936 (0.915)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          80.6%
  top-5          88.6%
  top-10         90.5%
Processing /media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/model_best.pth.tar file...
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='pitts', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/model_best.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/model_best.pth.tar'
=> Start epoch 3  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/213]	Time 0.215 (0.685)	Data 0.000 (0.444)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/313]	Time 1.115 (0.747)	Data 0.900 (0.532)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.9%
  top-5          93.7%
  top-10         95.3%
Use GPU: 0 for testing, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='5017', dataset='tokyo', scale='30k', test_batch_size=32, workers=2, height=480, width=640, num_clusters=64, arch='vgg16', nowhiten=False, sync_gather=False, features=4096, resume='/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/model_best.pth.tar', vlad=True, reduction=True, rerank=False, rr_topk=25, lambda_value=0, print_freq=10, data_dir='/mnt/ssd/usman_ws/OpenIBL/examples/data', logs_dir='/mnt/ssd/usman_ws/OpenIBL/examples/logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
=> Loaded checkpoint '/media/leo/2C737A9872F69ECF/why-so-deepv2-data/pittsburgh/netvlad-run/pitts30k-vgg16/conv5-sare_ind-lr0.001-tuple1-SFRS/model_best.pth.tar'
=> Start epoch 3  best recall5 95.8%
Evaluate on the test set:
load PCA parameters...
Extract Features: [200/315]	Time 0.020 (0.047)	Data 0.000 (0.019)	
gathering features from rank no.0
load PCA parameters...
Extract Features: [200/2375]	Time 0.215 (1.139)	Data 0.000 (0.915)	
Extract Features: [400/2375]	Time 0.214 (1.131)	Data 0.000 (0.912)	
Extract Features: [600/2375]	Time 0.215 (1.130)	Data 0.000 (0.912)	
Extract Features: [800/2375]	Time 0.215 (1.127)	Data 0.000 (0.910)	
Extract Features: [1000/2375]	Time 0.215 (1.124)	Data 0.000 (0.907)	
Extract Features: [1200/2375]	Time 0.214 (1.127)	Data 0.000 (0.911)	
Extract Features: [1400/2375]	Time 0.215 (1.126)	Data 0.000 (0.910)	
Extract Features: [1600/2375]	Time 0.216 (1.127)	Data 0.000 (0.911)	
Extract Features: [1800/2375]	Time 0.215 (1.129)	Data 0.000 (0.913)	
Extract Features: [2000/2375]	Time 0.215 (1.129)	Data 0.000 (0.913)	
Extract Features: [2200/2375]	Time 0.214 (1.130)	Data 0.000 (0.914)	
gathering features from rank no.0
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          81.0%
  top-5          87.6%
  top-10         89.5%
