Wed Mar 27 00:27:38 EDT 2024
/home/m.maqboolbhutta/usman_ws/codes/OpenIBL
/home/m.maqboolbhutta/.conda/envs/openibl/bin/python
Host: c1109a-s11
Other nodes: 
/home/m.maqboolbhutta/usman_ws/models/openibl/pitts-netvlad-sare_joint-lr-27-Mar
==========Starting Training=============
========================================
Use GPU: 1 for training, rank no.1 of world_size 8
Use GPU: 3 for training, rank no.3 of world_size 8
Use GPU: 4 for training, rank no.4 of world_size 8
Use GPU: 6 for training, rank no.6 of world_size 8
Use GPU: 7 for training, rank no.7 of world_size 8
Use GPU: 0 for training, rank no.0 of world_size 8
Use GPU: 2 for training, rank no.2 of world_size 8
Use GPU: 5 for training, rank no.5 of world_size 8
==========
Args:Namespace(arch='vgg16', cache_size=500, data_dir='/home/m.maqboolbhutta/usman_ws/codes/OpenIBL/examples/data/', dataset='pitts', deterministic=False, epochs=5, eval_step=1, features=4096, gpu=0, height=480, init_dir='/blue/hmedeiros/m.maqboolbhutta/datasets/openibl-init', iters=0, launcher='slurm', layers='conv5', logs_dir='/home/m.maqboolbhutta/usman_ws/models/openibl/pitts-netvlad-sare_joint-lr-27-Mar', loss_type='sare_joint', lr=0.001, margin=0.1, method='netvlad', momentum=0.9, neg_num=10, neg_pool=1000, ngpus_per_node=8, nowhiten=False, num_clusters=64, print_freq=200, rank=0, rerank=False, resume='', scale='30k', seed=43, step_size=5, sync_gather=True, syncbn=True, tcp_port='6010', test_batch_size=24, total_gpus=8, tuple_size=5, vlad=True, weight_decay=0.001, width=640, workers=4, world_size=8)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
No. of Clusters:  64
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/openibl-init/vgg16_pitts_64_desc_cen.hdf5
No. of Clusters:  64
No. of Clusters:  64
No. of Clusters:  64
No. of Clusters:  64
No. of Clusters:  64
No. of Clusters:  64
No. of Clusters:  64
Test the initial model:
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.8%
  top-5          92.7%
  top-10         95.7%
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.0%
  top-5          95.9%
  top-10         97.9%

 * Finished epoch   0 recall@1: 87.0%  recall@5: 95.9%  recall@10: 97.9%  best@5: 95.9% *

===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.9%
  top-5          96.1%
  top-10         97.9%

 * Finished epoch   1 recall@1: 87.9%  recall@5: 96.1%  recall@10: 97.9%  best@5: 96.1% *

===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.3%
  top-5          96.2%
  top-10         97.8%

 * Finished epoch   2 recall@1: 88.3%  recall@5: 96.2%  recall@10: 97.8%  best@5: 96.2% *

===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.2%
  top-5          96.1%
  top-10         97.8%

 * Finished epoch   3 recall@1: 88.2%  recall@5: 96.1%  recall@10: 97.8%  best@5: 96.2%

===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start extracting features for sorting gallery
===> Start calculating pairwise distances
===> Start sorting gallery
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.2%
  top-5          95.9%
  top-10         97.7%

 * Finished epoch   4 recall@1: 88.2%  recall@5: 95.9%  recall@10: 97.7%  best@5: 96.2%

Performing PCA reduction on the best model:
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/pitts-netvlad-sare_joint-lr-27-Mar/model_best.pth.tar'
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Testing on Pitts30k-test:
load PCA parameters...
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          86.0%
  top-5          92.9%
  top-10         94.8%
