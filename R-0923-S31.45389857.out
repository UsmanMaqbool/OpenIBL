Mon Sep 23 16:10:29 EDT 2024
/home/m.maqboolbhutta/usman_ws/codes/openibl3
/home/m.maqboolbhutta/.conda/envs/openibl3/bin/python
Host: c0906a-s23
Other nodes: 
/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep
==========Starting Training=============
========================================
Use GPU: 1 for training, rank no.1 of world_size 4
Use GPU: 3 for training, rank no.3 of world_size 4
Use GPU: 0 for training, rank no.0 of world_size 4
Use GPU: 2 for training, rank no.2 of world_size 4
==========
Args:Namespace(arch='vgg16', cache_size=1000, data_dir='/home/m.maqboolbhutta/usman_ws/codes/OpenIBL/examples/data/', dataset='pitts', deterministic=False, epochs=6, eval_step=1, fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, generations=4, gpu=0, height=480, init_dir='/blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init', iters=0, launcher='slurm', layers='conv5', logs_dir='/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep', loss_type='sare_ind', lr=0.001, margin=0.1, method='graphvlad', momentum=0.9, neg_num=10, neg_pool=1000, ngpus_per_node=4, nowhiten=False, num_clusters=64, pos_num=10, pos_pool=20, print_freq=500, rank=0, resume='', scale='30k', seed=43, soft_weight=0.5, step_size=5, sync_gather=False, syncbn=False, tcp_port='6010', temperature=[0.07, 0.07, 0.06, 0.05], test_batch_size=16, total_gpus=4, tuple_size=1, weight_decay=0.001, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init/vgg16_pitts_64_desc_cen.hdf5
===> Loading segmentation model
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init/vgg16_pitts_64_desc_cen.hdf5
===> Loading segmentation model
Test the initial model:
Extract Features: [100/276]	Time 0.198 (0.276)	Data 0.000 (0.055)	
Extract Features: [200/276]	Time 0.230 (0.246)	Data 0.000 (0.028)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          82.1%
  top-5          93.4%
  top-10         95.9%
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.211 (0.268)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.220 (0.240)	Data 0.000 (0.027)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [5-0][500/500]	Time 1.166 (1.313)	Data 0.987 (1.123)	Loss_hard 0.138 (0.240)	Loss_soft 4.732 (4.388)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.210 (0.266)	Data 0.000 (0.056)	
Extract Features: [200/271]	Time 0.221 (0.240)	Data 0.001 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [5-1][500/500]	Time 1.191 (1.318)	Data 1.024 (1.132)	Loss_hard 0.148 (0.180)	Loss_soft 4.096 (4.447)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.218 (0.277)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.215 (0.246)	Data 0.000 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [5-2][500/500]	Time 1.204 (1.316)	Data 1.019 (1.129)	Loss_hard 0.153 (0.167)	Loss_soft 4.280 (4.559)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.207 (0.272)	Data 0.006 (0.057)	
Extract Features: [200/271]	Time 0.218 (0.244)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.205 (0.270)	Data 0.000 (0.058)	
Extract Features: [200/276]	Time 0.215 (0.241)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.2%
  top-5          95.5%
  top-10         97.5%

 * Finished generation   0 epoch   5 recall@1: 88.2%  recall@5: 95.5%  recall@10: 97.5%  best@5: 95.5% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.200 (0.271)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.202 (0.243)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-0][500/500]	Time 1.184 (1.291)	Data 0.944 (1.095)	Loss_hard 0.086 (0.247)	Loss_soft 3.714 (3.629)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.221 (0.272)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.203 (0.245)	Data 0.001 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-1][500/500]	Time 1.166 (1.287)	Data 0.879 (1.089)	Loss_hard 0.928 (0.206)	Loss_soft 3.728 (3.585)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.197 (0.271)	Data 0.000 (0.056)	
Extract Features: [200/271]	Time 0.197 (0.243)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-2][500/500]	Time 1.181 (1.290)	Data 1.002 (1.096)	Loss_hard 0.344 (0.183)	Loss_soft 4.115 (3.529)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.226 (0.271)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.208 (0.242)	Data 0.001 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.254 (0.275)	Data 0.000 (0.058)	
Extract Features: [200/276]	Time 0.247 (0.245)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.9%
  top-5          96.0%
  top-10         97.7%

 * Finished generation   1 epoch   0 recall@1: 88.9%  recall@5: 96.0%  recall@10: 97.7%  best@5: 96.0% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.203 (0.270)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.193 (0.242)	Data 0.001 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-0][500/500]	Time 1.175 (1.296)	Data 1.006 (1.103)	Loss_hard 0.410 (0.150)	Loss_soft 3.966 (3.544)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.243 (0.278)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.195 (0.246)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-1][500/500]	Time 1.143 (1.295)	Data 0.899 (1.103)	Loss_hard 0.050 (0.124)	Loss_soft 3.299 (3.489)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.219 (0.274)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.238 (0.242)	Data 0.003 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-2][500/500]	Time 1.191 (1.294)	Data 0.991 (1.098)	Loss_hard 0.124 (0.121)	Loss_soft 3.639 (3.532)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.192 (0.280)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.199 (0.249)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.230 (0.275)	Data 0.000 (0.059)	
Extract Features: [200/276]	Time 0.209 (0.245)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.9%
  top-5          96.6%
  top-10         98.1%

 * Finished generation   1 epoch   1 recall@1: 89.9%  recall@5: 96.6%  recall@10: 98.1%  best@5: 96.6% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.205 (0.274)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.234 (0.242)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-0][500/500]	Time 1.145 (1.301)	Data 0.983 (1.104)	Loss_hard 0.151 (0.114)	Loss_soft 4.240 (3.525)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.209 (0.270)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.238 (0.241)	Data 0.001 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-1][500/500]	Time 1.165 (1.300)	Data 0.940 (1.101)	Loss_hard 0.045 (0.119)	Loss_soft 3.312 (3.503)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.215 (0.271)	Data 0.000 (0.056)	
Extract Features: [200/271]	Time 0.244 (0.243)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-2][500/500]	Time 1.178 (1.297)	Data 0.963 (1.105)	Loss_hard 0.215 (0.117)	Loss_soft 3.752 (3.533)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.254 (0.277)	Data 0.006 (0.059)	
Extract Features: [200/271]	Time 0.198 (0.245)	Data 0.000 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.203 (0.270)	Data 0.003 (0.060)	
Extract Features: [200/276]	Time 0.205 (0.241)	Data 0.001 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.8%
  top-5          96.3%
  top-10         97.7%

 * Finished generation   1 epoch   2 recall@1: 89.8%  recall@5: 96.3%  recall@10: 97.7%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.218 (0.270)	Data 0.006 (0.058)	
Extract Features: [200/271]	Time 0.209 (0.243)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-0][500/500]	Time 1.150 (1.301)	Data 0.920 (1.106)	Loss_hard 0.118 (0.092)	Loss_soft 3.915 (3.493)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.212 (0.275)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.197 (0.245)	Data 0.002 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-1][500/500]	Time 1.170 (1.295)	Data 1.002 (1.101)	Loss_hard 0.110 (0.108)	Loss_soft 4.301 (3.533)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.261 (0.275)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.204 (0.248)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-2][500/500]	Time 1.144 (1.292)	Data 0.979 (1.097)	Loss_hard 0.005 (0.090)	Loss_soft 2.455 (3.486)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.205 (0.269)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.215 (0.241)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.216 (0.279)	Data 0.001 (0.058)	
Extract Features: [200/276]	Time 0.223 (0.247)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.9%
  top-5          96.6%
  top-10         98.0%

 * Finished generation   1 epoch   3 recall@1: 89.9%  recall@5: 96.6%  recall@10: 98.0%  best@5: 96.6% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.209 (0.270)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.227 (0.241)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][500/500]	Time 1.121 (1.297)	Data 0.956 (1.105)	Loss_hard 0.060 (0.094)	Loss_soft 3.658 (3.550)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.200 (0.269)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.213 (0.242)	Data 0.002 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-1][500/500]	Time 1.182 (1.296)	Data 1.017 (1.102)	Loss_hard 0.178 (0.086)	Loss_soft 3.837 (3.482)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.211 (0.277)	Data 0.000 (0.061)	
Extract Features: [200/271]	Time 0.193 (0.248)	Data 0.000 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-2][500/500]	Time 1.150 (1.299)	Data 0.947 (1.105)	Loss_hard 0.012 (0.092)	Loss_soft 2.331 (3.520)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.209 (0.273)	Data 0.001 (0.061)	
Extract Features: [200/271]	Time 0.209 (0.245)	Data 0.000 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.212 (0.267)	Data 0.000 (0.058)	
Extract Features: [200/276]	Time 0.237 (0.240)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.0%
  top-5          96.6%
  top-10         98.1%

 * Finished generation   1 epoch   4 recall@1: 90.0%  recall@5: 96.6%  recall@10: 98.1%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.234 (0.273)	Data 0.001 (0.057)	
Extract Features: [200/271]	Time 0.230 (0.243)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [5-0][500/1000]	Time 1.264 (1.296)	Data 1.097 (1.104)	Loss_hard 0.040 (0.081)	Loss_soft 2.544 (3.511)
Epoch: [5-0][1000/1000]	Time 1.156 (1.291)	Data 0.985 (1.099)	Loss_hard 0.069 (0.077)	Loss_soft 3.857 (3.488)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.207 (0.271)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.202 (0.244)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [5-1][500/830]	Time 1.317 (1.298)	Data 1.144 (1.108)	Loss_hard 0.186 (0.085)	Loss_soft 3.898 (3.502)
Extract Features: [100/276]	Time 0.206 (0.283)	Data 0.006 (0.072)	
Extract Features: [200/276]	Time 0.248 (0.249)	Data 0.000 (0.037)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.0%
  top-5          96.6%
  top-10         98.2%

 * Finished generation   1 epoch   5 recall@1: 90.0%  recall@5: 96.6%  recall@10: 98.2%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.230 (0.273)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.223 (0.243)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-0][500/1000]	Time 1.287 (1.292)	Data 1.128 (1.096)	Loss_hard 0.081 (0.281)	Loss_soft 3.133 (3.365)
Epoch: [0-0][1000/1000]	Time 1.155 (1.285)	Data 0.987 (1.090)	Loss_hard 0.445 (0.256)	Loss_soft 4.006 (3.332)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.221 (0.273)	Data 0.020 (0.057)	
Extract Features: [200/271]	Time 0.204 (0.245)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-1][500/830]	Time 1.245 (1.290)	Data 1.052 (1.098)	Loss_hard 0.329 (0.183)	Loss_soft 3.422 (3.178)
Extract Features: [100/276]	Time 0.252 (0.272)	Data 0.000 (0.057)	
Extract Features: [200/276]	Time 0.208 (0.243)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.7%
  top-5          96.2%
  top-10         97.6%

 * Finished generation   2 epoch   0 recall@1: 88.7%  recall@5: 96.2%  recall@10: 97.6%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.239 (0.279)	Data 0.000 (0.061)	
Extract Features: [200/271]	Time 0.251 (0.247)	Data 0.015 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-0][500/1000]	Time 1.242 (1.294)	Data 0.984 (1.097)	Loss_hard 0.079 (0.163)	Loss_soft 3.149 (3.159)
Epoch: [1-0][1000/1000]	Time 1.170 (1.288)	Data 1.011 (1.093)	Loss_hard 0.078 (0.150)	Loss_soft 3.144 (3.118)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.197 (0.272)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.235 (0.244)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-1][500/830]	Time 1.278 (1.297)	Data 1.119 (1.102)	Loss_hard 0.069 (0.125)	Loss_soft 3.284 (3.109)
Extract Features: [100/276]	Time 0.197 (0.282)	Data 0.000 (0.071)	
Extract Features: [200/276]	Time 0.244 (0.249)	Data 0.000 (0.036)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.8%
  top-5          96.5%
  top-10         98.0%

 * Finished generation   2 epoch   1 recall@1: 89.8%  recall@5: 96.5%  recall@10: 98.0%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.224 (0.270)	Data 0.004 (0.061)	
Extract Features: [200/271]	Time 0.209 (0.242)	Data 0.000 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-0][500/1000]	Time 1.273 (1.298)	Data 1.068 (1.105)	Loss_hard 0.078 (0.107)	Loss_soft 3.430 (3.117)
Epoch: [2-0][1000/1000]	Time 1.165 (1.291)	Data 1.002 (1.099)	Loss_hard 0.038 (0.106)	Loss_soft 3.320 (3.101)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.209 (0.276)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.203 (0.246)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-1][500/830]	Time 1.298 (1.297)	Data 1.139 (1.105)	Loss_hard 0.115 (0.096)	Loss_soft 3.477 (3.085)
Extract Features: [100/276]	Time 0.216 (0.275)	Data 0.000 (0.062)	
Extract Features: [200/276]	Time 0.219 (0.243)	Data 0.000 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.9%
  top-5          96.4%
  top-10         97.9%

 * Finished generation   2 epoch   2 recall@1: 89.9%  recall@5: 96.4%  recall@10: 97.9%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.210 (0.271)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.220 (0.243)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-0][500/1000]	Time 1.263 (1.298)	Data 1.104 (1.109)	Loss_hard 0.120 (0.080)	Loss_soft 3.650 (3.028)
Epoch: [3-0][1000/1000]	Time 1.144 (1.291)	Data 0.951 (1.102)	Loss_hard 0.227 (0.087)	Loss_soft 3.772 (3.060)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.231 (0.283)	Data 0.000 (0.067)	
Extract Features: [200/271]	Time 0.223 (0.250)	Data 0.000 (0.034)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-1][500/830]	Time 1.333 (1.298)	Data 1.072 (1.110)	Loss_hard 0.011 (0.080)	Loss_soft 1.614 (3.041)
Extract Features: [100/276]	Time 0.213 (0.270)	Data 0.000 (0.058)	
Extract Features: [200/276]	Time 0.213 (0.242)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.5%
  top-5          96.6%
  top-10         98.0%

 * Finished generation   2 epoch   3 recall@1: 89.5%  recall@5: 96.6%  recall@10: 98.0%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.206 (0.272)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.226 (0.244)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][500/1000]	Time 1.284 (1.296)	Data 1.109 (1.102)	Loss_hard 0.026 (0.079)	Loss_soft 2.654 (3.089)
Epoch: [4-0][1000/1000]	Time 1.179 (1.289)	Data 1.000 (1.096)	Loss_hard 0.196 (0.074)	Loss_soft 3.379 (3.065)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.221 (0.275)	Data 0.002 (0.060)	
Extract Features: [200/271]	Time 0.214 (0.245)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-1][500/830]	Time 1.217 (1.296)	Data 1.058 (1.103)	Loss_hard 0.003 (0.073)	Loss_soft 2.284 (3.086)
Extract Features: [100/276]	Time 0.215 (0.288)	Data 0.000 (0.069)	
Extract Features: [200/276]	Time 0.232 (0.251)	Data 0.000 (0.035)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.2%
  top-5          96.6%
  top-10         98.2%

 * Finished generation   2 epoch   4 recall@1: 90.2%  recall@5: 96.6%  recall@10: 98.2%  best@5: 96.6% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.197 (0.273)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.207 (0.247)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [5-0][500/1830]	Time 1.312 (1.298)	Data 1.050 (1.105)	Loss_hard 0.019 (0.063)	Loss_soft 2.289 (3.076)
Epoch: [5-0][1000/1830]	Time 1.323 (1.292)	Data 1.113 (1.099)	Loss_hard 0.035 (0.059)	Loss_soft 3.292 (3.042)
Epoch: [5-0][1500/1830]	Time 1.305 (1.290)	Data 1.132 (1.097)	Loss_hard 0.096 (0.061)	Loss_soft 3.815 (3.045)
Extract Features: [100/276]	Time 0.230 (0.280)	Data 0.000 (0.070)	
Extract Features: [200/276]	Time 0.231 (0.246)	Data 0.000 (0.035)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.0%
  top-5          96.6%
  top-10         98.0%

 * Finished generation   2 epoch   5 recall@1: 90.0%  recall@5: 96.6%  recall@10: 98.0%  best@5: 96.6% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.204 (0.274)	Data 0.000 (0.059)	
Extract Features: [200/271]	Time 0.217 (0.244)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-0][500/1830]	Time 1.296 (1.295)	Data 1.137 (1.097)	Loss_hard 0.039 (0.292)	Loss_soft 2.814 (2.997)
Epoch: [0-0][1000/1830]	Time 1.290 (1.288)	Data 1.046 (1.089)	Loss_hard 0.422 (0.267)	Loss_soft 3.717 (2.919)
Epoch: [0-0][1500/1830]	Time 1.310 (1.287)	Data 1.140 (1.087)	Loss_hard 0.162 (0.250)	Loss_soft 3.110 (2.847)
Extract Features: [100/276]	Time 0.228 (0.273)	Data 0.000 (0.057)	
Extract Features: [200/276]	Time 0.194 (0.242)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.3%
  top-5          95.4%
  top-10         97.1%

 * Finished generation   3 epoch   0 recall@1: 88.3%  recall@5: 95.4%  recall@10: 97.1%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.203 (0.272)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.235 (0.244)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-0][500/1830]	Time 1.238 (1.298)	Data 0.986 (1.099)	Loss_hard 0.291 (0.168)	Loss_soft 2.951 (2.604)
Epoch: [1-0][1000/1830]	Time 1.223 (1.291)	Data 1.063 (1.092)	Loss_hard 0.071 (0.154)	Loss_soft 2.892 (2.547)
Epoch: [1-0][1500/1830]	Time 1.276 (1.288)	Data 1.117 (1.090)	Loss_hard 0.060 (0.146)	Loss_soft 2.298 (2.538)
Extract Features: [100/276]	Time 0.246 (0.271)	Data 0.000 (0.058)	
Extract Features: [200/276]	Time 0.212 (0.245)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.0%
  top-5          95.7%
  top-10         97.2%

 * Finished generation   3 epoch   1 recall@1: 88.0%  recall@5: 95.7%  recall@10: 97.2%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.235 (0.272)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.220 (0.241)	Data 0.004 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-0][500/1830]	Time 1.297 (1.296)	Data 1.138 (1.102)	Loss_hard 0.143 (0.106)	Loss_soft 3.126 (2.515)
Epoch: [2-0][1000/1830]	Time 1.242 (1.290)	Data 0.880 (1.094)	Loss_hard 0.032 (0.110)	Loss_soft 2.237 (2.491)
Epoch: [2-0][1500/1830]	Time 1.279 (1.288)	Data 1.120 (1.094)	Loss_hard 0.266 (0.105)	Loss_soft 3.293 (2.483)
Extract Features: [100/276]	Time 0.199 (0.272)	Data 0.000 (0.058)	
Extract Features: [200/276]	Time 0.212 (0.244)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.0%
  top-5          96.1%
  top-10         97.5%

 * Finished generation   3 epoch   2 recall@1: 89.0%  recall@5: 96.1%  recall@10: 97.5%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.232 (0.274)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.224 (0.245)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-0][500/1830]	Time 1.278 (1.300)	Data 1.107 (1.104)	Loss_hard 0.152 (0.081)	Loss_soft 2.748 (2.401)
Epoch: [3-0][1000/1830]	Time 1.298 (1.293)	Data 1.087 (1.097)	Loss_hard 0.151 (0.082)	Loss_soft 2.856 (2.418)
Epoch: [3-0][1500/1830]	Time 1.215 (1.291)	Data 1.045 (1.096)	Loss_hard 0.012 (0.079)	Loss_soft 1.230 (2.407)
Extract Features: [100/276]	Time 0.202 (0.276)	Data 0.000 (0.059)	
Extract Features: [200/276]	Time 0.201 (0.247)	Data 0.001 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.9%
  top-5          96.1%
  top-10         97.7%

 * Finished generation   3 epoch   3 recall@1: 88.9%  recall@5: 96.1%  recall@10: 97.7%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.218 (0.273)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.226 (0.241)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][500/1830]	Time 1.270 (1.297)	Data 1.078 (1.104)	Loss_hard 0.036 (0.072)	Loss_soft 2.128 (2.410)
Epoch: [4-0][1000/1830]	Time 1.293 (1.291)	Data 1.134 (1.097)	Loss_hard 0.206 (0.064)	Loss_soft 3.150 (2.385)
Epoch: [4-0][1500/1830]	Time 1.279 (1.288)	Data 1.082 (1.095)	Loss_hard 0.004 (0.064)	Loss_soft 1.309 (2.383)
Extract Features: [100/276]	Time 0.257 (0.271)	Data 0.000 (0.056)	
Extract Features: [200/276]	Time 0.230 (0.245)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.3%
  top-5          96.4%
  top-10         97.9%

 * Finished generation   3 epoch   4 recall@1: 89.3%  recall@5: 96.4%  recall@10: 97.9%  best@5: 96.6%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.216 (0.273)	Data 0.000 (0.058)	
Extract Features: [200/271]	Time 0.211 (0.243)	Data 0.000 (0.030)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [5-0][500/1830]	Time 1.322 (1.299)	Data 1.145 (1.107)	Loss_hard 0.024 (0.056)	Loss_soft 1.299 (2.431)
Epoch: [5-0][1000/1830]	Time 1.316 (1.293)	Data 1.147 (1.100)	Loss_hard 0.042 (0.053)	Loss_soft 1.802 (2.387)
Epoch: [5-0][1500/1830]	Time 1.295 (1.290)	Data 1.090 (1.098)	Loss_hard 0.086 (0.054)	Loss_soft 3.070 (2.385)
Extract Features: [100/276]	Time 0.209 (0.272)	Data 0.000 (0.057)	
Extract Features: [200/276]	Time 0.219 (0.245)	Data 0.014 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.1%
  top-5          96.5%
  top-10         97.9%

 * Finished generation   3 epoch   5 recall@1: 89.1%  recall@5: 96.5%  recall@10: 97.9%  best@5: 96.6%

Performing PCA reduction on the best model:
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/model_best.pth.tar'
Extract Features: [100/271]	Time 0.227 (0.267)	Data 0.000 (0.057)	
Extract Features: [200/271]	Time 0.266 (0.240)	Data 0.000 (0.029)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Testing on Pitts30k-test:
load PCA parameters...
Extract Features: [100/263]	Time 0.205 (0.272)	Data 0.000 (0.056)	
Extract Features: [200/263]	Time 0.209 (0.242)	Data 0.000 (0.028)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.7%
  top-5          94.4%
  top-10         95.9%
==========Testing=============
/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_5.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_5.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/model_best.pth.tar
==============================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar file on Pitts250k...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4
Use GPU: 3 for testing, rank no.3 of world_size 4
Use GPU: 2 for testing, rank no.2 of world_size 4

==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/data', dataset='pitts', fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar', rr_topk=25, scale='250k', sync_gather=False, tcp_port='5017', test_batch_size=16, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar'
=> Start epoch 4  best recall5 96.6%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar file on Pitts250k...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar file on Pitts30k...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/data', dataset='pitts', fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=16, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar'
=> Start epoch 4  best recall5 96.6%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar file on Pitts30k...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar file on Tokyo...
=======================================
Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/data', dataset='tokyo', fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=16, vlad=True, width=640, workers=2, world_size=4)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar'
=> Start epoch 4  best recall5 96.6%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_4.pth.tar file on Tokyo...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar file on Pitts250k...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/data', dataset='pitts', fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar', rr_topk=25, scale='250k', sync_gather=False, tcp_port='5017', test_batch_size=16, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar'
=> Start epoch 4  best recall5 96.6%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar file on Pitts250k...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar file on Pitts30k...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4
Use GPU: 2 for testing, rank no.2 of world_size 4


==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/data', dataset='pitts', fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=16, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar'
=> Start epoch 4  best recall5 96.6%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar file on Pitts30k...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar file on Tokyo...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4
Use GPU: 0 for testing, rank no.0 of world_size 4
Use GPU: 3 for testing, rank no.3 of world_size 4

==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/data', dataset='tokyo', fast_scnn='/home/m.maqboolbhutta/usman_ws/datasets/official/fast_scnn/fast_scnn_citys.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl3/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=16, vlad=True, width=640, workers=2, world_size=4)
==========
Tokyo dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |  4035  |    48420
  train_gallery |  4092  |    49104
  val_query     |  1308  |    15696
  val_gallery   |  2780  |    33360
  test_query    |    35  |      315
  test_gallery  |  6254  |    75984
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar'
=> Start epoch 4  best recall5 96.6%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint3_4.pth.tar file on Tokyo...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0923-ver1-fastscnn-fusion/vgg16-graphvlad_SFRS-sare_ind-pitts30k-lr0.001-tuple4-23-Sep/checkpoint2_5.pth.tar file on Pitts250k...
=======================================
