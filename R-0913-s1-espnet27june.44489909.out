Fri Sep 13 12:47:17 EDT 2024
/home/m.maqboolbhutta/usman_ws/codes/openibl2
/home/m.maqboolbhutta/.conda/envs/openibl2/bin/python
Host: c0910a-s35
Other nodes: 
/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep
==========Starting Training=============
========================================
Use GPU: 0 for training, rank no.0 of world_size 4
Use GPU: 1 for training, rank no.1 of world_size 4
Use GPU: 2 for training, rank no.2 of world_size 4
Use GPU: 3 for training, rank no.3 of world_size 4
==========
Args:Namespace(arch='vgg16', cache_size=1000, data_dir='/home/m.maqboolbhutta/usman_ws/codes/OpenIBL/examples/data/', dataset='pitts', deterministic=False, epochs=5, esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', eval_step=1, features=4096, generations=4, gpu=0, height=480, init_dir='/blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init', iters=0, launcher='slurm', layers='conv5', logs_dir='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep', loss_type='sare_ind', lr=0.001, margin=0.1, method='graphvlad', momentum=0.9, neg_num=10, neg_pool=1000, ngpus_per_node=4, nowhiten=False, num_clusters=64, pos_num=10, pos_pool=20, print_freq=200, rank=0, resume='', scale='30k', seed=43, soft_weight=0.5, step_size=5, sync_gather=False, syncbn=True, tcp_port='6010', temperature=[0.07, 0.07, 0.06, 0.05], test_batch_size=16, total_gpus=4, tuple_size=1, weight_decay=0.001, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init/vgg16_pitts_64_desc_cen.hdf5
===> Loading segmentation model
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init/vgg16_pitts_64_desc_cen.hdf5
===> Loading segmentation model
Test the initial model:
Extract Features: [100/276]	Time 0.445 (0.485)	Data 0.012 (0.045)	
Extract Features: [200/276]	Time 0.405 (0.444)	Data 0.000 (0.023)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.3%
  top-5          91.9%
  top-10         94.9%
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.405 (0.442)	Data 0.000 (0.045)	
Extract Features: [200/271]	Time 0.385 (0.421)	Data 0.000 (0.023)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][200/250]	Time 1.284 (1.314)	Data 0.932 (1.111)	Loss_hard 0.528 (0.266)	Loss_soft 4.386 (4.276)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.387 (0.465)	Data 0.006 (0.065)	
Extract Features: [200/271]	Time 0.386 (0.435)	Data 0.000 (0.033)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-1][200/250]	Time 1.282 (1.308)	Data 1.124 (1.115)	Loss_hard 0.314 (0.230)	Loss_soft 4.389 (4.327)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.398 (0.451)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.393 (0.428)	Data 0.001 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-2][200/250]	Time 1.283 (1.305)	Data 1.051 (1.114)	Loss_hard 0.404 (0.197)	Loss_soft 4.507 (4.418)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.404 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.425 (0.429)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-3][200/250]	Time 1.279 (1.305)	Data 1.011 (1.109)	Loss_hard 0.231 (0.156)	Loss_soft 4.584 (4.448)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.387 (0.450)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.410 (0.426)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-4][200/250]	Time 1.276 (1.309)	Data 1.013 (1.109)	Loss_hard 0.024 (0.167)	Loss_soft 4.269 (4.497)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.382 (0.464)	Data 0.000 (0.060)	
Extract Features: [200/271]	Time 0.425 (0.433)	Data 0.000 (0.031)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-5][200/250]	Time 1.283 (1.309)	Data 1.099 (1.113)	Loss_hard 0.506 (0.153)	Loss_soft 3.533 (4.569)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.391 (0.454)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.449 (0.431)	Data 0.006 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-6][200/250]	Time 1.277 (1.308)	Data 1.119 (1.113)	Loss_hard 0.104 (0.181)	Loss_soft 4.550 (4.594)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.393 (0.450)	Data 0.001 (0.049)	
Extract Features: [200/271]	Time 0.401 (0.427)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.387 (0.452)	Data 0.000 (0.050)	
Extract Features: [200/276]	Time 0.393 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          86.5%
  top-5          95.1%
  top-10         97.0%

 * Finished generation   0 epoch   4 recall@1: 86.5%  recall@5: 95.1%  recall@10: 97.0%  best@5: 95.1% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.414 (0.456)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.408 (0.431)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-0][200/250]	Time 1.220 (1.289)	Data 1.015 (1.089)	Loss_hard 0.310 (0.310)	Loss_soft 4.395 (3.756)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.390 (0.449)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.423 (0.430)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-1][200/250]	Time 1.330 (1.291)	Data 1.048 (1.081)	Loss_hard 0.261 (0.237)	Loss_soft 3.797 (3.558)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.389 (0.444)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.436 (0.427)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-2][200/250]	Time 1.239 (1.296)	Data 0.952 (1.092)	Loss_hard 0.043 (0.232)	Loss_soft 2.421 (3.589)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.386 (0.447)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.394 (0.424)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-3][200/250]	Time 1.277 (1.289)	Data 1.070 (1.082)	Loss_hard 0.063 (0.191)	Loss_soft 3.523 (3.579)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.419 (0.451)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.408 (0.432)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-4][200/250]	Time 1.247 (1.288)	Data 1.054 (1.086)	Loss_hard 0.158 (0.179)	Loss_soft 3.438 (3.510)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.404 (0.455)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.392 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-5][200/250]	Time 1.296 (1.289)	Data 1.037 (1.081)	Loss_hard 0.065 (0.189)	Loss_soft 3.716 (3.588)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.380 (0.451)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.395 (0.426)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-6][200/250]	Time 1.290 (1.285)	Data 1.038 (1.092)	Loss_hard 0.002 (0.159)	Loss_soft 1.801 (3.599)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.416 (0.450)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.402 (0.427)	Data 0.002 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.404 (0.456)	Data 0.000 (0.049)	
Extract Features: [200/276]	Time 0.393 (0.430)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.4%
  top-5          95.8%
  top-10         97.4%

 * Finished generation   1 epoch   0 recall@1: 87.4%  recall@5: 95.8%  recall@10: 97.4%  best@5: 95.8% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.397 (0.447)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.424 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-0][200/250]	Time 1.266 (1.289)	Data 1.107 (1.092)	Loss_hard 0.477 (0.154)	Loss_soft 3.350 (3.518)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.396 (0.451)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.410 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-1][200/250]	Time 1.268 (1.290)	Data 0.936 (1.088)	Loss_hard 0.032 (0.150)	Loss_soft 2.827 (3.634)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.435 (0.448)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.387 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-2][200/250]	Time 1.256 (1.291)	Data 1.031 (1.086)	Loss_hard 0.069 (0.127)	Loss_soft 3.477 (3.468)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.421 (0.454)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.420 (0.433)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-3][200/250]	Time 1.225 (1.288)	Data 1.067 (1.090)	Loss_hard 0.380 (0.137)	Loss_soft 4.259 (3.536)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.386 (0.454)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.412 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-4][200/250]	Time 1.214 (1.288)	Data 1.041 (1.089)	Loss_hard 0.050 (0.120)	Loss_soft 3.434 (3.509)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.398 (0.452)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.405 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-5][200/250]	Time 1.297 (1.291)	Data 1.135 (1.091)	Loss_hard 0.336 (0.123)	Loss_soft 3.980 (3.531)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.400 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.411 (0.425)	Data 0.019 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-6][200/250]	Time 1.257 (1.295)	Data 1.081 (1.102)	Loss_hard 0.121 (0.144)	Loss_soft 3.768 (3.600)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.396 (0.456)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.423 (0.429)	Data 0.022 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.407 (0.456)	Data 0.000 (0.051)	
Extract Features: [200/276]	Time 0.448 (0.431)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.4%
  top-5          96.0%
  top-10         97.9%

 * Finished generation   1 epoch   1 recall@1: 88.4%  recall@5: 96.0%  recall@10: 97.9%  best@5: 96.0% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.396 (0.453)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.403 (0.430)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-0][200/250]	Time 1.284 (1.299)	Data 1.039 (1.099)	Loss_hard 0.021 (0.113)	Loss_soft 2.807 (3.510)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.422 (0.452)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.448 (0.432)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-1][200/250]	Time 1.291 (1.299)	Data 1.066 (1.094)	Loss_hard 0.026 (0.135)	Loss_soft 3.212 (3.607)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.390 (0.451)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.401 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-2][200/250]	Time 1.268 (1.293)	Data 1.003 (1.090)	Loss_hard 0.077 (0.123)	Loss_soft 4.073 (3.565)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.382 (0.451)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.386 (0.430)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-3][200/250]	Time 1.238 (1.297)	Data 0.954 (1.089)	Loss_hard 0.055 (0.102)	Loss_soft 4.105 (3.469)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.409 (0.451)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.404 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-4][200/250]	Time 1.280 (1.307)	Data 1.115 (1.105)	Loss_hard 0.013 (0.115)	Loss_soft 3.362 (3.525)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.401 (0.458)	Data 0.006 (0.051)	
Extract Features: [200/271]	Time 0.407 (0.429)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-5][200/250]	Time 1.264 (1.293)	Data 1.059 (1.091)	Loss_hard 0.087 (0.104)	Loss_soft 3.779 (3.531)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.458)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.431 (0.434)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-6][200/250]	Time 1.309 (1.298)	Data 1.092 (1.092)	Loss_hard 0.020 (0.110)	Loss_soft 2.387 (3.524)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.402 (0.458)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.389 (0.431)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.406 (0.452)	Data 0.000 (0.050)	
Extract Features: [200/276]	Time 0.406 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.9%
  top-5          96.1%
  top-10         97.6%

 * Finished generation   1 epoch   2 recall@1: 88.9%  recall@5: 96.1%  recall@10: 97.6%  best@5: 96.1% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.407 (0.450)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.423 (0.427)	Data 0.012 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-0][200/250]	Time 1.268 (1.291)	Data 1.110 (1.093)	Loss_hard 0.073 (0.092)	Loss_soft 3.488 (3.531)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.451)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.386 (0.427)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-1][200/250]	Time 1.253 (1.292)	Data 0.836 (1.083)	Loss_hard 0.056 (0.083)	Loss_soft 2.665 (3.493)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.391 (0.449)	Data 0.001 (0.048)	
Extract Features: [200/271]	Time 0.431 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-2][200/250]	Time 1.232 (1.295)	Data 1.042 (1.092)	Loss_hard 0.083 (0.106)	Loss_soft 3.097 (3.506)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.383 (0.447)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.430 (0.424)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-3][200/250]	Time 1.256 (1.292)	Data 1.050 (1.081)	Loss_hard 0.061 (0.101)	Loss_soft 4.013 (3.628)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.385 (0.454)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.445 (0.430)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-4][200/250]	Time 1.260 (1.297)	Data 1.090 (1.094)	Loss_hard 0.071 (0.092)	Loss_soft 4.266 (3.551)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.409 (0.446)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.421 (0.429)	Data 0.006 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-5][200/250]	Time 1.288 (1.298)	Data 1.111 (1.094)	Loss_hard 0.042 (0.097)	Loss_soft 3.727 (3.461)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.386 (0.450)	Data 0.001 (0.050)	
Extract Features: [200/271]	Time 0.415 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-6][200/250]	Time 1.271 (1.298)	Data 1.113 (1.093)	Loss_hard 0.064 (0.090)	Loss_soft 3.233 (3.558)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.378 (0.450)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.412 (0.429)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.399 (0.451)	Data 0.000 (0.050)	
Extract Features: [200/276]	Time 0.402 (0.423)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.8%
  top-5          96.0%
  top-10         97.6%

 * Finished generation   1 epoch   3 recall@1: 88.8%  recall@5: 96.0%  recall@10: 97.6%  best@5: 96.1%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.387 (0.446)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.416 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][200/250]	Time 1.231 (1.293)	Data 1.009 (1.095)	Loss_hard 0.349 (0.098)	Loss_soft 3.845 (3.515)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.376 (0.446)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.419 (0.424)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-1][200/250]	Time 1.261 (1.294)	Data 0.871 (1.089)	Loss_hard 0.069 (0.105)	Loss_soft 3.575 (3.528)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.402 (0.444)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.396 (0.423)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-2][200/250]	Time 1.265 (1.296)	Data 1.032 (1.093)	Loss_hard 0.127 (0.095)	Loss_soft 3.879 (3.470)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.378 (0.450)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.393 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-3][200/250]	Time 1.295 (1.293)	Data 1.078 (1.091)	Loss_hard 0.106 (0.084)	Loss_soft 3.986 (3.494)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.386 (0.449)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.404 (0.430)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-4][200/250]	Time 1.286 (1.294)	Data 1.127 (1.092)	Loss_hard 0.005 (0.092)	Loss_soft 3.297 (3.473)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.400 (0.452)	Data 0.000 (0.054)	
Extract Features: [200/271]	Time 0.399 (0.426)	Data 0.000 (0.027)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-5][200/250]	Time 1.239 (1.294)	Data 1.080 (1.097)	Loss_hard 0.118 (0.089)	Loss_soft 3.685 (3.542)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.388 (0.447)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.391 (0.427)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-6][200/250]	Time 1.233 (1.293)	Data 1.013 (1.093)	Loss_hard 0.125 (0.104)	Loss_soft 4.317 (3.549)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.387 (0.459)	Data 0.000 (0.055)	
Extract Features: [200/271]	Time 0.399 (0.433)	Data 0.000 (0.028)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.403 (0.455)	Data 0.000 (0.050)	
Extract Features: [200/276]	Time 0.412 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.5%
  top-5          95.9%
  top-10         97.4%

 * Finished generation   1 epoch   4 recall@1: 88.5%  recall@5: 95.9%  recall@10: 97.4%  best@5: 96.1%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.387 (0.449)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.425 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-0][200/250]	Time 1.226 (1.292)	Data 1.025 (1.088)	Loss_hard 0.604 (0.329)	Loss_soft 3.897 (3.583)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.422 (0.448)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.407 (0.428)	Data 0.015 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-1][200/250]	Time 1.323 (1.293)	Data 1.153 (1.093)	Loss_hard 0.313 (0.248)	Loss_soft 3.510 (3.278)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.423 (0.454)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.412 (0.431)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-2][200/250]	Time 1.207 (1.289)	Data 0.948 (1.071)	Loss_hard 0.052 (0.254)	Loss_soft 2.445 (3.267)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.389 (0.452)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.414 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-3][200/250]	Time 1.272 (1.293)	Data 1.047 (1.092)	Loss_hard 0.098 (0.214)	Loss_soft 2.927 (3.246)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.397 (0.452)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.426 (0.431)	Data 0.010 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-4][200/250]	Time 1.245 (1.290)	Data 1.022 (1.073)	Loss_hard 0.080 (0.193)	Loss_soft 2.916 (3.139)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.405 (0.448)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.463 (0.427)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-5][200/250]	Time 1.302 (1.293)	Data 1.096 (1.090)	Loss_hard 0.033 (0.214)	Loss_soft 2.751 (3.187)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.408 (0.450)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.395 (0.430)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-6][200/250]	Time 1.273 (1.295)	Data 1.115 (1.092)	Loss_hard 0.002 (0.179)	Loss_soft 1.494 (3.283)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.402 (0.449)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.396 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.390 (0.454)	Data 0.000 (0.050)	
Extract Features: [200/276]	Time 0.465 (0.433)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.3%
  top-5          95.4%
  top-10         97.1%

 * Finished generation   2 epoch   0 recall@1: 87.3%  recall@5: 95.4%  recall@10: 97.1%  best@5: 96.1%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.414 (0.450)	Data 0.007 (0.050)	
Extract Features: [200/271]	Time 0.399 (0.431)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-0][200/250]	Time 1.251 (1.292)	Data 1.036 (1.089)	Loss_hard 0.198 (0.148)	Loss_soft 2.520 (3.111)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.397 (0.446)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.392 (0.425)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-1][200/250]	Time 1.285 (1.294)	Data 1.121 (1.091)	Loss_hard 0.030 (0.157)	Loss_soft 2.603 (3.247)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.406 (0.453)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.400 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-2][200/250]	Time 1.267 (1.294)	Data 0.968 (1.091)	Loss_hard 0.077 (0.135)	Loss_soft 2.637 (3.122)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.387 (0.447)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.439 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-3][200/250]	Time 1.297 (1.294)	Data 1.139 (1.082)	Loss_hard 0.667 (0.136)	Loss_soft 4.033 (3.182)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.391 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.378 (0.425)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-4][200/250]	Time 1.267 (1.296)	Data 1.108 (1.096)	Loss_hard 0.073 (0.127)	Loss_soft 3.344 (3.128)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.386 (0.447)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.429 (0.428)	Data 0.016 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-5][200/250]	Time 1.281 (1.294)	Data 1.120 (1.089)	Loss_hard 0.493 (0.134)	Loss_soft 3.447 (3.174)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.393 (0.453)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.382 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-6][200/250]	Time 1.266 (1.299)	Data 1.095 (1.090)	Loss_hard 0.150 (0.145)	Loss_soft 3.572 (3.180)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.390 (0.446)	Data 0.001 (0.048)	
Extract Features: [200/271]	Time 0.385 (0.423)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.396 (0.448)	Data 0.000 (0.047)	
Extract Features: [200/276]	Time 0.399 (0.428)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.2%
  top-5          96.0%
  top-10         97.5%

 * Finished generation   2 epoch   1 recall@1: 88.2%  recall@5: 96.0%  recall@10: 97.5%  best@5: 96.1%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.382 (0.449)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.407 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-0][200/250]	Time 1.280 (1.292)	Data 1.122 (1.086)	Loss_hard 0.011 (0.102)	Loss_soft 2.575 (3.122)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.415 (0.450)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.380 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-1][200/250]	Time 1.316 (1.301)	Data 1.119 (1.097)	Loss_hard 0.055 (0.112)	Loss_soft 2.644 (3.239)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.457)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.391 (0.430)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-2][200/250]	Time 1.264 (1.300)	Data 1.015 (1.095)	Loss_hard 0.116 (0.112)	Loss_soft 3.331 (3.149)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.405 (0.448)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.388 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-3][200/250]	Time 1.260 (1.295)	Data 1.102 (1.085)	Loss_hard 0.052 (0.101)	Loss_soft 3.420 (3.094)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.447)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.391 (0.423)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-4][200/250]	Time 1.248 (1.298)	Data 1.087 (1.098)	Loss_hard 0.019 (0.097)	Loss_soft 2.479 (3.124)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.452)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.434 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-5][200/250]	Time 1.266 (1.293)	Data 1.107 (1.092)	Loss_hard 0.071 (0.093)	Loss_soft 3.418 (3.129)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.424 (0.454)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.393 (0.430)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-6][200/250]	Time 1.319 (1.293)	Data 1.160 (1.099)	Loss_hard 0.014 (0.105)	Loss_soft 2.657 (3.126)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.398 (0.449)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.406 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.396 (0.464)	Data 0.000 (0.052)	
Extract Features: [200/276]	Time 0.409 (0.436)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.9%
  top-5          96.0%
  top-10         97.7%

 * Finished generation   2 epoch   2 recall@1: 88.9%  recall@5: 96.0%  recall@10: 97.7%  best@5: 96.1%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.403 (0.446)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.401 (0.426)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-0][200/250]	Time 1.245 (1.296)	Data 1.086 (1.091)	Loss_hard 0.085 (0.079)	Loss_soft 3.083 (3.087)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.401 (0.452)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.396 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-1][200/250]	Time 1.275 (1.296)	Data 1.066 (1.096)	Loss_hard 0.054 (0.068)	Loss_soft 2.808 (3.031)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.450)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.408 (0.427)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-2][200/250]	Time 1.268 (1.297)	Data 1.110 (1.094)	Loss_hard 0.042 (0.089)	Loss_soft 2.269 (3.111)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.409 (0.444)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.439 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-3][200/250]	Time 1.264 (1.296)	Data 1.083 (1.095)	Loss_hard 0.073 (0.093)	Loss_soft 3.113 (3.230)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.401 (0.453)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.400 (0.428)	Data 0.006 (0.027)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-4][200/250]	Time 1.252 (1.295)	Data 1.073 (1.097)	Loss_hard 0.099 (0.084)	Loss_soft 3.837 (3.166)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.390 (0.447)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.412 (0.423)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-5][200/250]	Time 1.202 (1.296)	Data 1.044 (1.088)	Loss_hard 0.011 (0.084)	Loss_soft 3.321 (3.111)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.383 (0.447)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.421 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-6][200/250]	Time 1.265 (1.296)	Data 1.107 (1.102)	Loss_hard 0.051 (0.077)	Loss_soft 1.432 (3.143)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.407 (0.446)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.396 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.398 (0.449)	Data 0.000 (0.050)	
Extract Features: [200/276]	Time 0.433 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.7%
  top-5          96.1%
  top-10         97.6%

 * Finished generation   2 epoch   3 recall@1: 88.7%  recall@5: 96.1%  recall@10: 97.6%  best@5: 96.1%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.410 (0.450)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.431 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][200/250]	Time 1.242 (1.297)	Data 1.085 (1.092)	Loss_hard 0.268 (0.071)	Loss_soft 3.970 (3.100)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.389 (0.451)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.423 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-1][200/250]	Time 1.274 (1.293)	Data 1.090 (1.090)	Loss_hard 0.079 (0.091)	Loss_soft 3.050 (3.061)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.388 (0.449)	Data 0.000 (0.046)	
Extract Features: [200/271]	Time 0.395 (0.427)	Data 0.000 (0.023)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-2][200/250]	Time 1.271 (1.295)	Data 1.106 (1.101)	Loss_hard 0.078 (0.072)	Loss_soft 3.574 (3.051)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.393 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.403 (0.425)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-3][200/250]	Time 1.255 (1.294)	Data 1.097 (1.091)	Loss_hard 0.167 (0.079)	Loss_soft 3.417 (3.050)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.434 (0.454)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.399 (0.431)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-4][200/250]	Time 1.284 (1.298)	Data 1.125 (1.100)	Loss_hard 0.008 (0.070)	Loss_soft 3.526 (3.075)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.383 (0.448)	Data 0.001 (0.050)	
Extract Features: [200/271]	Time 0.412 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-5][200/250]	Time 1.288 (1.297)	Data 1.113 (1.092)	Loss_hard 0.081 (0.076)	Loss_soft 3.678 (3.103)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.389 (0.453)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.432 (0.432)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-6][200/250]	Time 1.231 (1.300)	Data 1.074 (1.101)	Loss_hard 0.061 (0.091)	Loss_soft 3.577 (3.135)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.413 (0.457)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.398 (0.429)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.405 (0.449)	Data 0.000 (0.048)	
Extract Features: [200/276]	Time 0.414 (0.430)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.3%
  top-5          96.4%
  top-10         97.8%

 * Finished generation   2 epoch   4 recall@1: 89.3%  recall@5: 96.4%  recall@10: 97.8%  best@5: 96.4% *

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.391 (0.453)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.412 (0.426)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-0][200/250]	Time 1.204 (1.294)	Data 0.994 (1.092)	Loss_hard 0.582 (0.328)	Loss_soft 3.455 (3.254)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.425 (0.447)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.394 (0.425)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-1][200/250]	Time 1.220 (1.289)	Data 0.910 (1.086)	Loss_hard 0.081 (0.285)	Loss_soft 2.130 (2.815)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.428 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.406 (0.432)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-2][200/250]	Time 1.260 (1.295)	Data 0.985 (1.101)	Loss_hard 0.035 (0.271)	Loss_soft 1.204 (2.825)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.398 (0.451)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.413 (0.425)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-3][200/250]	Time 1.252 (1.293)	Data 0.942 (1.086)	Loss_hard 0.076 (0.206)	Loss_soft 2.253 (2.706)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.390 (0.456)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.426 (0.430)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-4][200/250]	Time 1.274 (1.295)	Data 1.098 (1.088)	Loss_hard 0.248 (0.214)	Loss_soft 3.024 (2.556)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.398 (0.448)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.413 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-5][200/250]	Time 1.202 (1.295)	Data 1.028 (1.098)	Loss_hard 0.029 (0.204)	Loss_soft 1.918 (2.612)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.421 (0.458)	Data 0.006 (0.052)	
Extract Features: [200/271]	Time 0.424 (0.432)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-6][200/250]	Time 1.240 (1.299)	Data 0.905 (1.099)	Loss_hard 0.003 (0.189)	Loss_soft 1.521 (2.737)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.405 (0.445)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.397 (0.422)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.406 (0.445)	Data 0.000 (0.049)	
Extract Features: [200/276]	Time 0.425 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.7%
  top-5          95.6%
  top-10         97.2%

 * Finished generation   3 epoch   0 recall@1: 87.7%  recall@5: 95.6%  recall@10: 97.2%  best@5: 96.4%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.408 (0.454)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.397 (0.431)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-0][200/250]	Time 1.269 (1.294)	Data 1.111 (1.095)	Loss_hard 0.311 (0.153)	Loss_soft 3.088 (2.535)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.398 (0.457)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.408 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-1][200/250]	Time 1.275 (1.294)	Data 1.116 (1.093)	Loss_hard 0.025 (0.171)	Loss_soft 1.832 (2.682)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.453)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.399 (0.430)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-2][200/250]	Time 1.270 (1.298)	Data 1.111 (1.098)	Loss_hard 0.146 (0.145)	Loss_soft 2.086 (2.445)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.413 (0.455)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.428 (0.433)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-3][200/250]	Time 1.296 (1.298)	Data 1.098 (1.097)	Loss_hard 0.532 (0.145)	Loss_soft 3.626 (2.574)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.394 (0.453)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.393 (0.431)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-4][200/250]	Time 1.291 (1.296)	Data 1.070 (1.099)	Loss_hard 0.089 (0.126)	Loss_soft 2.929 (2.537)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.438 (0.454)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.413 (0.431)	Data 0.000 (0.027)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-5][200/250]	Time 1.226 (1.303)	Data 1.058 (1.098)	Loss_hard 0.397 (0.129)	Loss_soft 3.152 (2.498)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.391 (0.457)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.410 (0.433)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-6][200/250]	Time 1.259 (1.301)	Data 1.093 (1.102)	Loss_hard 0.030 (0.154)	Loss_soft 2.142 (2.629)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.408 (0.452)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.441 (0.431)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.379 (0.450)	Data 0.000 (0.051)	
Extract Features: [200/276]	Time 0.395 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.6%
  top-5          95.3%
  top-10         97.2%

 * Finished generation   3 epoch   1 recall@1: 87.6%  recall@5: 95.3%  recall@10: 97.2%  best@5: 96.4%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.391 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.414 (0.425)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-0][200/250]	Time 1.281 (1.296)	Data 1.099 (1.091)	Loss_hard 0.026 (0.098)	Loss_soft 1.693 (2.445)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.397 (0.448)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.400 (0.426)	Data 0.007 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-1][200/250]	Time 1.252 (1.302)	Data 1.094 (1.105)	Loss_hard 0.030 (0.112)	Loss_soft 1.594 (2.585)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.392 (0.451)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.417 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-2][200/250]	Time 1.242 (1.299)	Data 1.078 (1.108)	Loss_hard 0.049 (0.112)	Loss_soft 2.779 (2.503)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.386 (0.450)	Data 0.001 (0.051)	
Extract Features: [200/271]	Time 0.443 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-3][200/250]	Time 1.265 (1.294)	Data 1.046 (1.093)	Loss_hard 0.130 (0.103)	Loss_soft 2.528 (2.422)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.401 (0.455)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.443 (0.433)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-4][200/250]	Time 1.273 (1.297)	Data 1.061 (1.098)	Loss_hard 0.010 (0.098)	Loss_soft 1.075 (2.515)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.420 (0.453)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.423 (0.434)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-5][200/250]	Time 1.271 (1.298)	Data 1.015 (1.095)	Loss_hard 0.032 (0.089)	Loss_soft 2.452 (2.485)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.391 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.392 (0.427)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-6][200/250]	Time 1.259 (1.297)	Data 1.101 (1.104)	Loss_hard 0.012 (0.103)	Loss_soft 1.960 (2.520)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.422 (0.451)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.396 (0.426)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.396 (0.451)	Data 0.000 (0.051)	
Extract Features: [200/276]	Time 0.446 (0.429)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.7%
  top-5          95.4%
  top-10         97.2%

 * Finished generation   3 epoch   2 recall@1: 87.7%  recall@5: 95.4%  recall@10: 97.2%  best@5: 96.4%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.390 (0.450)	Data 0.001 (0.050)	
Extract Features: [200/271]	Time 0.407 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-0][200/250]	Time 1.279 (1.302)	Data 1.074 (1.103)	Loss_hard 0.048 (0.070)	Loss_soft 2.595 (2.417)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.399 (0.451)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.400 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-1][200/250]	Time 1.224 (1.296)	Data 1.066 (1.095)	Loss_hard 0.047 (0.068)	Loss_soft 2.299 (2.321)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.412 (0.450)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.427 (0.425)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-2][200/250]	Time 1.242 (1.296)	Data 1.058 (1.103)	Loss_hard 0.027 (0.103)	Loss_soft 1.400 (2.440)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.394 (0.449)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.419 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-3][200/250]	Time 1.266 (1.300)	Data 1.012 (1.097)	Loss_hard 0.127 (0.076)	Loss_soft 3.202 (2.540)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.395 (0.446)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.404 (0.424)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-4][200/250]	Time 1.234 (1.300)	Data 1.050 (1.103)	Loss_hard 0.061 (0.073)	Loss_soft 3.329 (2.422)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.378 (0.448)	Data 0.000 (0.047)	
Extract Features: [200/271]	Time 0.391 (0.427)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-5][200/250]	Time 1.294 (1.300)	Data 1.136 (1.099)	Loss_hard 0.002 (0.074)	Loss_soft 2.392 (2.408)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.414 (0.453)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.425 (0.429)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-6][200/250]	Time 1.264 (1.298)	Data 1.087 (1.101)	Loss_hard 0.002 (0.068)	Loss_soft 2.170 (2.460)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.384 (0.448)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.434 (0.426)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.391 (0.457)	Data 0.000 (0.051)	
Extract Features: [200/276]	Time 0.456 (0.433)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.1%
  top-5          95.8%
  top-10         97.5%

 * Finished generation   3 epoch   3 recall@1: 88.1%  recall@5: 95.8%  recall@10: 97.5%  best@5: 96.4%

===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.410 (0.449)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.389 (0.424)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][200/250]	Time 1.254 (1.298)	Data 1.039 (1.096)	Loss_hard 0.149 (0.070)	Loss_soft 3.878 (2.356)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.393 (0.450)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.395 (0.430)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-1][200/250]	Time 1.269 (1.300)	Data 1.070 (1.103)	Loss_hard 0.054 (0.073)	Loss_soft 2.594 (2.411)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.374 (0.451)	Data 0.000 (0.048)	
Extract Features: [200/271]	Time 0.406 (0.429)	Data 0.000 (0.024)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-2][200/250]	Time 1.274 (1.300)	Data 1.021 (1.109)	Loss_hard 0.130 (0.061)	Loss_soft 3.536 (2.410)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.430 (0.449)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.398 (0.424)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-3][200/250]	Time 1.292 (1.300)	Data 1.133 (1.105)	Loss_hard 0.058 (0.060)	Loss_soft 2.320 (2.350)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.384 (0.447)	Data 0.000 (0.052)	
Extract Features: [200/271]	Time 0.412 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-4][200/250]	Time 1.225 (1.298)	Data 1.040 (1.093)	Loss_hard 0.008 (0.059)	Loss_soft 2.251 (2.339)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.394 (0.453)	Data 0.000 (0.053)	
Extract Features: [200/271]	Time 0.394 (0.424)	Data 0.000 (0.027)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-5][200/250]	Time 1.300 (1.300)	Data 1.142 (1.088)	Loss_hard 0.036 (0.058)	Loss_soft 2.214 (2.408)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.414 (0.451)	Data 0.000 (0.050)	
Extract Features: [200/271]	Time 0.424 (0.427)	Data 0.002 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-6][200/250]	Time 1.295 (1.298)	Data 1.050 (1.098)	Loss_hard 0.077 (0.087)	Loss_soft 3.023 (2.505)
===> Start extracting features for sorting gallery
Extract Features: [100/271]	Time 0.387 (0.449)	Data 0.000 (0.051)	
Extract Features: [200/271]	Time 0.432 (0.429)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/276]	Time 0.384 (0.450)	Data 0.000 (0.052)	
Extract Features: [200/276]	Time 0.445 (0.428)	Data 0.000 (0.026)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.1%
  top-5          95.8%
  top-10         97.5%

 * Finished generation   3 epoch   4 recall@1: 88.1%  recall@5: 95.8%  recall@10: 97.5%  best@5: 96.4%

Performing PCA reduction on the best model:
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/model_best.pth.tar'
Extract Features: [100/271]	Time 0.391 (0.450)	Data 0.000 (0.049)	
Extract Features: [200/271]	Time 0.394 (0.428)	Data 0.000 (0.025)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Testing on Pitts30k-test:
load PCA parameters...
Extract Features: [100/263]	Time 0.384 (0.451)	Data 0.000 (0.052)	
Extract Features: [200/263]	Time 0.406 (0.427)	Data 0.000 (0.027)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.2%
  top-5          94.2%
  top-10         95.5%
==========Testing=============
/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint0_4.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_0.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_1.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_2.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_3.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_4.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_0.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_1.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_2.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_3.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_4.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_0.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_1.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_2.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_3.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_4.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/model_best.pth.tar
==============================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint0_4.pth.tar file...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4
Use GPU: 0 for testing, rank no.0 of world_size 4
Use GPU: 2 for testing, rank no.2 of world_size 4

==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint0_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint0_4.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint0_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint0_4.h5
=> Start epoch 4  best recall5 95.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint0_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint0_4.h5
Extract Features: [100/136]	Time 0.743 (0.876)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.827 (0.808)	Data 0.000 (0.048)	
Extract Features: [200/656]	Time 0.744 (0.788)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.769 (0.791)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.816 (0.791)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.780 (0.786)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.756 (0.787)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.6%
  top-5          95.4%
  top-10         96.7%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint0_4.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_0.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_0.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_0.pth.tar'
PCA parameters path: PCA parameters path:   /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_0.h5/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_0.h5

PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_0.h5
=> Start epoch 0  best recall5 95.8%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_0.h5
Extract Features: [100/136]	Time 0.722 (0.856)	Data 0.000 (0.043)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.757 (0.816)	Data 0.000 (0.048)	
Extract Features: [200/656]	Time 0.812 (0.800)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.793 (0.793)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.779 (0.786)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.784 (0.783)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.788 (0.781)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.9%
  top-5          95.8%
  top-10         97.1%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_0.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_1.pth.tar file...
=======================================
Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_1.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_1.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_1.h5
=> Start epoch 1  best recall5 96.0%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_1.h5
Extract Features: [100/136]	Time 0.723 (0.871)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.821 (0.847)	Data 0.000 (0.045)	
Extract Features: [200/656]	Time 0.759 (0.816)	Data 0.000 (0.023)	
Extract Features: [300/656]	Time 0.848 (0.815)	Data 0.000 (0.015)	
Extract Features: [400/656]	Time 0.799 (0.812)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.791 (0.809)	Data 0.000 (0.009)	
Extract Features: [600/656]	Time 0.742 (0.804)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.3%
  top-5          95.9%
  top-10         97.3%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_1.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_2.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_2.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model===> Loading segmentation model

===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_2.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_2.h5
=> Start epoch 2  best recall5 96.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_2.h5
Extract Features: [100/136]	Time 0.738 (0.866)	Data 0.000 (0.045)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.767 (0.823)	Data 0.000 (0.045)	
Extract Features: [200/656]	Time 0.747 (0.799)	Data 0.000 (0.023)	
Extract Features: [300/656]	Time 0.760 (0.791)	Data 0.000 (0.015)	
Extract Features: [400/656]	Time 0.821 (0.788)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.766 (0.784)	Data 0.000 (0.009)	
Extract Features: [600/656]	Time 0.777 (0.782)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.4%
  top-5          96.2%
  top-10         97.2%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_2.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_3.pth.tar file...
=======================================
Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_3.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_3.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_3.h5
=> Start epoch 3  best recall5 96.1%PCA parameters path: 
 /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_3.h5
Extract Features: [100/136]	Time 0.694 (0.849)	Data 0.000 (0.043)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.733 (0.818)	Data 0.000 (0.048)	
Extract Features: [200/656]	Time 0.717 (0.779)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.735 (0.769)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.778 (0.766)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.736 (0.765)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.724 (0.761)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.4%
  top-5          96.0%
  top-10         97.2%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_3.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_4.pth.tar file...
=======================================
Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_4.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_4.h5
=> Start epoch 4  best recall5 96.1%
PCA parameters path: PCA parameters path:   /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_4.h5/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint1_4.h5

Extract Features: [100/136]	Time 0.762 (0.873)	Data 0.000 (0.046)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.761 (0.799)	Data 0.000 (0.049)	
Extract Features: [200/656]	Time 0.749 (0.773)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.744 (0.763)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.746 (0.757)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.759 (0.754)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.725 (0.751)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.6%
  top-5          96.3%
  top-10         97.3%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint1_4.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_0.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_0.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_0.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_0.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_0.h5
PCA parameters path: => Start epoch 0  best recall5 96.1% 
/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_0.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_0.h5
Extract Features: [100/136]	Time 0.736 (0.888)	Data 0.000 (0.042)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.780 (0.805)	Data 0.000 (0.048)	
Extract Features: [200/656]	Time 0.777 (0.787)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.751 (0.784)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.851 (0.781)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.756 (0.778)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.766 (0.775)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.4%
  top-5          95.9%
  top-10         97.0%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_0.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_1.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_1.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model===> Loading segmentation model

===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_1.pth.tar'
=> Start epoch 1  best recall5 96.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_1.h5
Extract Features: [100/136]	Time 0.788 (0.913)	Data 0.000 (0.043)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.797 (0.832)	Data 0.000 (0.049)	
Extract Features: [200/656]	Time 0.760 (0.797)	Data 0.000 (0.025)	
Extract Features: [300/656]	Time 0.785 (0.787)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.766 (0.782)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.767 (0.780)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.751 (0.778)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.7%
  top-5          96.0%
  top-10         97.2%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_1.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_2.pth.tar file...
=======================================
Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4

Use GPU: 1 for testing, rank no.1 of world_size 4

==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_2.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_2.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_2.h5
=> Start epoch 2  best recall5 96.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_2.h5
Extract Features: [100/136]	Time 0.720 (0.854)	Data 0.000 (0.043)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.794 (0.812)	Data 0.000 (0.047)	
Extract Features: [200/656]	Time 0.726 (0.788)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.785 (0.781)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.771 (0.777)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.737 (0.774)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.733 (0.772)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.9%
  top-5          96.3%
  top-10         97.3%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_2.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_3.pth.tar file...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_3.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_3.pth.tar'
=> Start epoch 3  best recall5 96.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_3.h5
Extract Features: [100/136]	Time 0.847 (0.873)	Data 0.000 (0.042)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.757 (0.803)	Data 0.000 (0.050)	
Extract Features: [200/656]	Time 0.753 (0.783)	Data 0.000 (0.025)	
Extract Features: [300/656]	Time 0.751 (0.781)	Data 0.000 (0.017)	
Extract Features: [400/656]	Time 0.811 (0.778)	Data 0.000 (0.013)	
Extract Features: [500/656]	Time 0.824 (0.786)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.815 (0.792)	Data 0.000 (0.009)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          91.1%
  top-5          96.2%
  top-10         97.4%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_3.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_4.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_4.pth.tar'
=> Start epoch 4  best recall5 96.4%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint2_4.h5
Extract Features: [100/136]	Time 0.774 (0.869)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.738 (0.795)	Data 0.000 (0.047)	
Extract Features: [200/656]	Time 0.728 (0.769)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.729 (0.761)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.755 (0.757)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.743 (0.756)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.737 (0.754)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.8%
  top-5          96.5%
  top-10         97.6%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint2_4.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_0.pth.tar file...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_0.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_0.pth.tar'
=> Start epoch 0  best recall5 96.4%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_0.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_0.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_0.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_0.h5
Extract Features: [100/136]	Time 0.762 (0.870)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.778 (0.817)	Data 0.000 (0.045)	
Extract Features: [200/656]	Time 0.750 (0.787)	Data 0.000 (0.022)	
Extract Features: [300/656]	Time 0.779 (0.779)	Data 0.000 (0.015)	
Extract Features: [400/656]	Time 0.780 (0.779)	Data 0.000 (0.011)	
Extract Features: [500/656]	Time 0.793 (0.779)	Data 0.000 (0.009)	
Extract Features: [600/656]	Time 0.738 (0.779)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.8%
  top-5          95.6%
  top-10         96.8%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_0.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_1.pth.tar file...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_1.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_1.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_1.h5
=> Start epoch 1  best recall5 96.4%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_1.h5
Extract Features: [100/136]	Time 0.713 (0.867)	Data 0.000 (0.042)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.772 (0.821)	Data 0.000 (0.046)	
Extract Features: [200/656]	Time 0.730 (0.789)	Data 0.000 (0.023)	
Extract Features: [300/656]	Time 0.771 (0.779)	Data 0.000 (0.015)	
Extract Features: [400/656]	Time 0.759 (0.780)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.744 (0.774)	Data 0.000 (0.009)	
Extract Features: [600/656]	Time 0.800 (0.774)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.0%
  top-5          95.6%
  top-10         97.1%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_1.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_2.pth.tar file...
=======================================
Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_2.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_2.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_2.h5
=> Start epoch 2  best recall5 96.4%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_2.h5
Extract Features: [100/136]	Time 0.736 (0.861)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.780 (0.816)	Data 0.000 (0.049)	
Extract Features: [200/656]	Time 0.748 (0.793)	Data 0.000 (0.025)	
Extract Features: [300/656]	Time 0.741 (0.780)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.797 (0.774)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.752 (0.770)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.741 (0.767)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.7%
  top-5          96.4%
  top-10         97.5%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_2.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_3.pth.tar file...
=======================================
Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_3.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_3.pth.tar'
=> Start epoch 3  best recall5 96.4%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_3.h5
Extract Features: [100/136]	Time 0.716 (0.860)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.802 (0.825)	Data 0.000 (0.051)	
Extract Features: [200/656]	Time 0.770 (0.799)	Data 0.000 (0.026)	
Extract Features: [300/656]	Time 0.776 (0.786)	Data 0.000 (0.017)	
Extract Features: [400/656]	Time 0.761 (0.779)	Data 0.000 (0.013)	
Extract Features: [500/656]	Time 0.737 (0.776)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.726 (0.773)	Data 0.000 (0.009)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          91.0%
  top-5          96.2%
  top-10         97.4%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_3.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_4.pth.tar file...
=======================================
Use GPU: 2 for testing, rank no.2 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_4.pth.tar'
=> Start epoch 4  best recall5 96.4%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_checkpoint3_4.h5
Extract Features: [100/136]	Time 0.781 (0.882)	Data 0.000 (0.043)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.778 (0.811)	Data 0.000 (0.049)	
Extract Features: [200/656]	Time 0.749 (0.784)	Data 0.000 (0.025)	
Extract Features: [300/656]	Time 0.759 (0.777)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.753 (0.772)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.786 (0.769)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.764 (0.769)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          91.3%
  top-5          96.8%
  top-10         97.5%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/checkpoint3_4.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/model_best.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/model_best.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/model_best.pth.tar'
=> Start epoch 4  best recall5 96.4%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_model_best.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_model_best.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_model_best.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/pca_params_model_best.h5
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.760 (0.816)	Data 0.000 (0.046)	
Extract Features: [200/656]	Time 0.796 (0.788)	Data 0.000 (0.023)	
Extract Features: [300/656]	Time 0.765 (0.793)	Data 0.000 (0.015)	
Extract Features: [400/656]	Time 0.805 (0.797)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.805 (0.796)	Data 0.000 (0.009)	
Extract Features: [600/656]	Time 0.790 (0.796)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          90.9%
  top-5          96.1%
  top-10         97.4%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_ind-pitts30k-lr0.001-tuple4-13-Sep/model_best.pth.tar file...
=======================================
/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep
==========Starting Training=============
========================================
Use GPU: 2 for training, rank no.2 of world_size 4
Use GPU: 1 for training, rank no.1 of world_size 4
Use GPU: 3 for training, rank no.3 of world_size 4
Use GPU: 0 for training, rank no.0 of world_size 4
==========
Args:Namespace(arch='vgg16', cache_size=1000, data_dir='/home/m.maqboolbhutta/usman_ws/codes/OpenIBL/examples/data/', dataset='pitts', deterministic=False, epochs=5, esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', eval_step=1, features=4096, gpu=0, height=480, init_dir='/blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init', iters=0, launcher='slurm', layers='conv5', logs_dir='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep', loss_type='sare_joint', lr=0.001, margin=0.1, method='graphvlad', momentum=0.9, neg_num=10, neg_pool=1000, ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=200, rank=0, rerank=False, resume='', scale='30k', seed=43, step_size=5, sync_gather=True, syncbn=True, tcp_port='6010', test_batch_size=32, total_gpus=4, tuple_size=1, vlad=True, weight_decay=0.001, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
No. of Clusters:  64
Loading centroids from /blue/hmedeiros/m.maqboolbhutta/datasets/official/openibl-init/vgg16_pitts_64_desc_cen.hdf5
===> Loading segmentation model
Test the initial model:
Extract Features: [100/138]	Time 0.751 (0.861)	Data 0.000 (0.049)	
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          79.3%
  top-5          91.9%
  top-10         94.9%
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.793 (0.818)	Data 0.000 (0.048)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-0][200/250]	Time 1.058 (1.059)	Data 0.497 (0.553)	Loss 1.068 (1.061)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.809 (0.842)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-1][200/250]	Time 1.031 (1.063)	Data 0.519 (0.551)	Loss 1.808 (0.866)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.803 (0.842)	Data 0.000 (0.054)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-2][200/250]	Time 1.015 (1.062)	Data 0.462 (0.551)	Loss 0.258 (0.817)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.811 (0.827)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-3][200/250]	Time 1.030 (1.061)	Data 0.524 (0.554)	Loss 0.108 (0.574)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.797 (0.836)	Data 0.000 (0.053)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-4][200/250]	Time 1.022 (1.061)	Data 0.509 (0.546)	Loss 0.654 (0.542)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.861 (0.843)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-5][200/250]	Time 1.016 (1.061)	Data 0.512 (0.550)	Loss 0.103 (0.526)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.780 (0.835)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [0-6][200/250]	Time 1.019 (1.061)	Data 0.532 (0.548)	Loss 0.001 (0.422)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.782 (0.860)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/138]	Time 0.763 (0.835)	Data 0.000 (0.055)	
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          84.4%
  top-5          92.9%
  top-10         94.9%

 * Finished epoch   0 recall@1: 84.4%  recall@5: 92.9%  recall@10: 94.9%  best@5: 92.9% *

===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.781 (0.835)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-0][200/250]	Time 1.035 (1.060)	Data 0.508 (0.548)	Loss 0.508 (0.478)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.787 (0.829)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-1][200/250]	Time 1.030 (1.062)	Data 0.491 (0.552)	Loss 0.051 (0.450)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.775 (0.837)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-2][200/250]	Time 1.035 (1.062)	Data 0.545 (0.550)	Loss 0.067 (0.304)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.827 (0.853)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-3][200/250]	Time 1.034 (1.062)	Data 0.494 (0.549)	Loss 0.252 (0.331)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.775 (0.834)	Data 0.000 (0.050)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-4][200/250]	Time 1.031 (1.060)	Data 0.525 (0.551)	Loss 0.011 (0.253)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.768 (0.832)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-5][200/250]	Time 1.011 (1.061)	Data 0.483 (0.548)	Loss 0.329 (0.329)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.857 (0.846)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [1-6][200/250]	Time 1.027 (1.060)	Data 0.490 (0.550)	Loss 0.022 (0.383)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.818 (0.842)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/138]	Time 0.786 (0.839)	Data 0.000 (0.054)	
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          85.4%
  top-5          94.1%
  top-10         96.6%

 * Finished epoch   1 recall@1: 85.4%  recall@5: 94.1%  recall@10: 96.6%  best@5: 94.1% *

===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.765 (0.850)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-0][200/250]	Time 1.045 (1.061)	Data 0.489 (0.546)	Loss 0.010 (0.235)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.806 (0.846)	Data 0.000 (0.053)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-1][200/250]	Time 1.028 (1.061)	Data 0.525 (0.551)	Loss 0.003 (0.307)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.814 (0.838)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-2][200/250]	Time 1.012 (1.062)	Data 0.528 (0.554)	Loss 0.011 (0.331)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.788 (0.837)	Data 0.000 (0.054)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-3][200/250]	Time 1.028 (1.063)	Data 0.540 (0.553)	Loss 0.008 (0.312)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.780 (0.845)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-4][200/250]	Time 1.031 (1.060)	Data 0.491 (0.548)	Loss 0.009 (0.255)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.749 (0.850)	Data 0.000 (0.054)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-5][200/250]	Time 1.051 (1.061)	Data 0.560 (0.548)	Loss 0.020 (0.253)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.808 (0.846)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [2-6][200/250]	Time 1.016 (1.062)	Data 0.532 (0.548)	Loss 0.001 (0.271)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.846 (0.839)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/138]	Time 0.801 (0.845)	Data 0.000 (0.054)	
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          84.8%
  top-5          93.8%
  top-10         96.1%

 * Finished epoch   2 recall@1: 84.8%  recall@5: 93.8%  recall@10: 96.1%  best@5: 94.1%

===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.771 (0.852)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-0][200/250]	Time 1.026 (1.060)	Data 0.542 (0.547)	Loss 0.115 (0.126)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.830 (0.865)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-1][200/250]	Time 1.043 (1.060)	Data 0.530 (0.549)	Loss 0.001 (0.163)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.816 (0.844)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-2][200/250]	Time 1.027 (1.063)	Data 0.544 (0.550)	Loss 0.002 (0.189)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.826 (0.832)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-3][200/250]	Time 1.045 (1.062)	Data 0.488 (0.551)	Loss 0.086 (0.174)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.766 (0.831)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-4][200/250]	Time 1.017 (1.059)	Data 0.495 (0.547)	Loss 0.101 (0.184)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.775 (0.851)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-5][200/250]	Time 1.021 (1.060)	Data 0.528 (0.551)	Loss 0.000 (0.171)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.754 (0.835)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [3-6][200/250]	Time 1.045 (1.060)	Data 0.468 (0.548)	Loss 0.041 (0.123)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.793 (0.856)	Data 0.000 (0.055)	
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/138]	Time 0.738 (0.836)	Data 0.000 (0.052)	
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          84.4%
  top-5          93.4%
  top-10         95.9%

 * Finished epoch   3 recall@1: 84.4%  recall@5: 93.4%  recall@10: 95.9%  best@5: 94.1%

===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.766 (0.847)	Data 0.000 (0.053)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-0][200/250]	Time 1.045 (1.062)	Data 0.558 (0.550)	Loss 1.417 (0.111)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.807 (0.838)	Data 0.000 (0.055)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-1][200/250]	Time 1.022 (1.059)	Data 0.534 (0.551)	Loss 0.072 (0.161)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.752 (0.836)	Data 0.000 (0.049)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-2][200/250]	Time 1.018 (1.061)	Data 0.518 (0.552)	Loss 0.181 (0.129)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.744 (0.842)	Data 0.001 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-3][200/250]	Time 1.089 (1.063)	Data 0.548 (0.554)	Loss 0.059 (0.135)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.756 (0.853)	Data 0.000 (0.053)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-4][200/250]	Time 1.037 (1.062)	Data 0.534 (0.548)	Loss 0.002 (0.128)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.795 (0.846)	Data 0.000 (0.050)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-5][200/250]	Time 1.051 (1.062)	Data 0.543 (0.547)	Loss 0.111 (0.175)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.775 (0.844)	Data 0.000 (0.051)	
===> Start calculating pairwise distances
===> Start sorting gallery
Epoch: [4-6][200/250]	Time 1.019 (1.062)	Data 0.516 (0.552)	Loss 0.021 (0.195)
===> Start extracting features for sorting gallery
Extract Features: [100/136]	Time 0.763 (0.835)	Data 0.000 (0.053)	
===> Start calculating pairwise distances
===> Start sorting gallery
Extract Features: [100/138]	Time 0.762 (0.836)	Data 0.000 (0.050)	
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          84.5%
  top-5          92.9%
  top-10         95.6%

 * Finished epoch   4 recall@1: 84.5%  recall@5: 92.9%  recall@10: 95.6%  best@5: 94.1%

Performing PCA reduction on the best model:
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/model_best.pth.tar'
Extract Features: [100/136]	Time 0.825 (0.855)	Data 0.000 (0.051)	
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Testing on Pitts30k-test:
load PCA parameters...
Extract Features: [100/132]	Time 0.859 (0.836)	Data 0.000 (0.050)	
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          87.5%
  top-5          93.9%
  top-10         95.6%
==========Testing=============
/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint0.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint1.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint2.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint3.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint4.pth.tar /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/model_best.pth.tar
==============================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint0.pth.tar file...
=======================================
Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4
Use GPU: 0 for testing, rank no.0 of world_size 4
Use GPU: 2 for testing, rank no.2 of world_size 4

==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint0.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint0.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint0.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint0.h5
=> Start epoch 0  best recall5 92.9%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint0.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint0.h5
Extract Features: [100/136]	Time 0.781 (0.855)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.779 (0.817)	Data 0.000 (0.052)	
Extract Features: [200/656]	Time 0.742 (0.799)	Data 0.000 (0.026)	
Extract Features: [300/656]	Time 0.760 (0.789)	Data 0.000 (0.018)	
Extract Features: [400/656]	Time 0.812 (0.788)	Data 0.000 (0.013)	
Extract Features: [500/656]	Time 0.766 (0.787)	Data 0.000 (0.011)	
Extract Features: [600/656]	Time 0.744 (0.788)	Data 0.000 (0.009)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          88.8%
  top-5          94.9%
  top-10         96.4%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint0.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint1.pth.tar file...
=======================================
Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4
Use GPU: 2 for testing, rank no.2 of world_size 4


==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint1.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint1.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint1.h5
=> Start epoch 1  best recall5 94.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint1.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint1.h5
Extract Features: [100/136]	Time 0.699 (0.834)	Data 0.000 (0.045)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.727 (0.811)	Data 0.000 (0.047)	
Extract Features: [200/656]	Time 0.812 (0.786)	Data 0.000 (0.023)	
Extract Features: [300/656]	Time 0.795 (0.778)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.728 (0.775)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.815 (0.773)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.769 (0.772)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.1%
  top-5          95.1%
  top-10         96.4%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint1.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint2.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint2.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint2.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint2.h5
=> Start epoch 2  best recall5 94.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint2.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint2.h5
Extract Features: [100/136]	Time 0.746 (0.855)	Data 0.000 (0.044)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.723 (0.832)	Data 0.000 (0.049)	
Extract Features: [200/656]	Time 0.764 (0.820)	Data 0.000 (0.025)	
Extract Features: [300/656]	Time 0.770 (0.803)	Data 0.000 (0.017)	
Extract Features: [400/656]	Time 0.743 (0.793)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.793 (0.789)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.739 (0.787)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.3%
  top-5          95.2%
  top-10         96.7%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint2.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint3.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint3.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint3.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint3.h5
=> Start epoch 3  best recall5 94.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint3.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint3.h5
Extract Features: [100/136]	Time 0.737 (0.840)	Data 0.000 (0.043)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.786 (0.821)	Data 0.000 (0.048)	
Extract Features: [200/656]	Time 0.724 (0.792)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.780 (0.780)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.726 (0.773)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.755 (0.770)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.740 (0.767)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.4%
  top-5          95.7%
  top-10         97.0%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint3.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint4.pth.tar file...
=======================================
Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint4.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint4.pth.tar'
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint4.h5
PCA parameters path: => Start epoch 4  best recall5 94.1% 
/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint4.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_checkpoint4.h5
Extract Features: [100/136]	Time 0.737 (0.850)	Data 0.000 (0.045)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
calculating PCA parameters...
================= PCA RESULT ==================
U: (32768, 4096)
lams: (4096,)
mu: (32768, 1)
Utmu: (4096, 1)
===============================================
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.718 (0.777)	Data 0.000 (0.047)	
Extract Features: [200/656]	Time 0.774 (0.756)	Data 0.000 (0.024)	
Extract Features: [300/656]	Time 0.741 (0.747)	Data 0.000 (0.016)	
Extract Features: [400/656]	Time 0.727 (0.742)	Data 0.000 (0.012)	
Extract Features: [500/656]	Time 0.786 (0.741)	Data 0.000 (0.010)	
Extract Features: [600/656]	Time 0.726 (0.738)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.2%
  top-5          94.7%
  top-10         96.4%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/checkpoint4.pth.tar file...
=======================================
==========################=============
 Testing /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/model_best.pth.tar file...
=======================================
Use GPU: 3 for testing, rank no.3 of world_size 4Use GPU: 0 for testing, rank no.0 of world_size 4Use GPU: 1 for testing, rank no.1 of world_size 4Use GPU: 2 for testing, rank no.2 of world_size 4



==========
Args:Namespace(arch='vgg16', data_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/data', dataset='pitts', esp_encoder='/home/m.maqboolbhutta/usman_ws/datasets/netvlad-official/espnet-encoder/espnet_p_2_q_8.pth', features=4096, gpu=0, height=480, lambda_value=0, launcher='pytorch', logs_dir='/blue/hmedeiros/m.maqboolbhutta/codes/openibl2/examples/logs', method='graphvlad', ngpus_per_node=4, nowhiten=False, num_clusters=64, print_freq=10, rank=0, reduction=True, rerank=False, resume='/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/model_best.pth.tar', rr_topk=25, scale='30k', sync_gather=False, tcp_port='5017', test_batch_size=32, vlad=True, width=640, workers=2, world_size=4)
==========
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   311  |     7320
  train_gallery |   417  |    10000
  val_query     |   319  |     7608
  val_gallery   |   417  |    10000
  test_query    |   286  |     6816
  test_gallery  |   417  |    10000
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
===> Loading segmentation model
=> Loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/model_best.pth.tar'
=> Start epoch 1  best recall5 94.1%
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_model_best.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_model_best.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_model_best.h5
PCA parameters path:  /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/pca_params_model_best.h5
Evaluate on the test set:
==========Test on Pitts250k=============
Pittsburgh dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   |   332  |     7800
  train_gallery |  3811  |    91464
  val_query     |   319  |     7608
  val_gallery   |  3277  |    78648
  test_query    |   347  |     8280
  test_gallery  |  3498  |    83952
load PCA parameters...
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
load PCA parameters...
Extract Features: [100/656]	Time 0.729 (0.789)	Data 0.000 (0.045)	
Extract Features: [200/656]	Time 0.736 (0.766)	Data 0.000 (0.023)	
Extract Features: [300/656]	Time 0.741 (0.759)	Data 0.000 (0.015)	
Extract Features: [400/656]	Time 0.750 (0.756)	Data 0.000 (0.011)	
Extract Features: [500/656]	Time 0.761 (0.754)	Data 0.000 (0.009)	
Extract Features: [600/656]	Time 0.744 (0.753)	Data 0.000 (0.008)	
gathering features from rank no.0
gathering features from rank no.1
gathering features from rank no.2
gathering features from rank no.3
===> Start calculating pairwise distances
===> Start calculating recalls
Recall Scores:
  top-1          89.1%
  top-5          95.1%
  top-10         96.2%
==========################=============
 Done Testing with /home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-sare_joint-pitts30k-lr0.001-tuple4-14-Sep/model_best.pth.tar file...
=======================================
/home/m.maqboolbhutta/usman_ws/models/openibl/0913/espnet/vgg16-graphvlad-triplet-pitts30k-lr0.001-tuple4-15-Sep
==========Starting Training=============
========================================
