/home/leo/usman_ws/models/openibl/official/mapillary30k-vgg16/conv5-triplet-lr0.0001-tuple1-29-Sep
==========Starting Training=============
========================================
Use GPU: 0 for training, rank no.0 of world_size 1
==========
Args:Namespace(launcher='pytorch', tcp_port='6010', dataset='mapillary', scale='30k', tuple_size=1, test_batch_size=32, cache_size=1000, workers=1, height=480, width=640, neg_num=10, num_clusters=64, neg_pool=1000, arch='vgg16', layers='conv5', nowhiten=False, syncbn=True, sync_gather=True, features=4096, lr=0.0001, momentum=0.9, weight_decay=0.001, loss_type='triplet', step_size=5, resume='', vlad=True, eval_step=1, rerank=False, epochs=5, iters=0, seed=43, deterministic=False, print_freq=200, margin=0.1, data_dir='/home/leo/usman_ws/codes/OpenIBL/examples/data', logs_dir='/home/leo/usman_ws/models/openibl/official/mapillary30k-vgg16/conv5-triplet-lr0.0001-tuple1-29-Sep', init_dir='/home/leo/usman_ws/codes/OpenIBL/examples/../logs', rank=0, ngpus_per_node=1, gpu=0, world_size=1)
==========
22168
Mapillary dataset loaded
  subset        | # pids | # images
  ---------------------------------
  train_query   | 441277  |   502704
  train_gallery | 915202  |   915202
  val_query     | 11084  |    22168
  val_gallery   | 18871  |    37742
  test_query    |     0  |        0
  test_gallery  |     0  |        0
Query: 0:32000 and DB 0:48000
Query: 0:32000 and DB 48000:96000
Query: 0:32000 and DB 96000:144000
Query: 0:32000 and DB 144000:192000
Query: 0:32000 and DB 192000:240000
Query: 0:32000 and DB 240000:288000
Query: 0:32000 and DB 288000:336000
Query: 0:32000 and DB 336000:384000
Query: 0:32000 and DB 384000:432000
Query: 0:32000 and DB 432000:480000
Query: 0:32000 and DB 480000:528000
Query: 0:32000 and DB 528000:576000
Query: 0:32000 and DB 576000:624000
Query: 0:32000 and DB 624000:672000
Query: 0:32000 and DB 672000:720000
Query: 0:32000 and DB 720000:768000
Query: 0:32000 and DB 768000:816000
Query: 0:32000 and DB 816000:864000
Query: 0:32000 and DB 864000:912000
Query: 0:32000 and DB 912000:915202
Query: 32000:64000 and DB 0:48000
Query: 32000:64000 and DB 48000:96000
Query: 32000:64000 and DB 96000:144000
Query: 32000:64000 and DB 144000:192000
Query: 32000:64000 and DB 192000:240000
Query: 32000:64000 and DB 240000:288000
Query: 32000:64000 and DB 288000:336000
Query: 32000:64000 and DB 336000:384000
Query: 32000:64000 and DB 384000:432000
Query: 32000:64000 and DB 432000:480000
Query: 32000:64000 and DB 480000:528000
Query: 32000:64000 and DB 528000:576000
Query: 32000:64000 and DB 576000:624000
Query: 32000:64000 and DB 624000:672000
Query: 32000:64000 and DB 672000:720000
Query: 32000:64000 and DB 720000:768000
Query: 32000:64000 and DB 768000:816000
Query: 32000:64000 and DB 816000:864000
Query: 32000:64000 and DB 864000:912000
Query: 32000:64000 and DB 912000:915202
Query: 64000:96000 and DB 0:48000
Query: 64000:96000 and DB 48000:96000
Query: 64000:96000 and DB 96000:144000
Query: 64000:96000 and DB 144000:192000
Query: 64000:96000 and DB 192000:240000
Query: 64000:96000 and DB 240000:288000
Query: 64000:96000 and DB 288000:336000
Query: 64000:96000 and DB 336000:384000
Query: 64000:96000 and DB 384000:432000
Query: 64000:96000 and DB 432000:480000
Query: 64000:96000 and DB 480000:528000
Query: 64000:96000 and DB 528000:576000
Query: 64000:96000 and DB 576000:624000
Query: 64000:96000 and DB 624000:672000
Query: 64000:96000 and DB 672000:720000
Query: 64000:96000 and DB 720000:768000
Query: 64000:96000 and DB 768000:816000
Query: 64000:96000 and DB 816000:864000
Query: 64000:96000 and DB 864000:912000
Query: 64000:96000 and DB 912000:915202
Query: 96000:128000 and DB 0:48000
Query: 96000:128000 and DB 48000:96000
Query: 96000:128000 and DB 96000:144000
Query: 96000:128000 and DB 144000:192000
Query: 96000:128000 and DB 192000:240000
Query: 96000:128000 and DB 240000:288000
Query: 96000:128000 and DB 288000:336000
Query: 96000:128000 and DB 336000:384000
Query: 96000:128000 and DB 384000:432000
Query: 96000:128000 and DB 432000:480000
Query: 96000:128000 and DB 480000:528000
Query: 96000:128000 and DB 528000:576000
Query: 96000:128000 and DB 576000:624000
Query: 96000:128000 and DB 624000:672000
Query: 96000:128000 and DB 672000:720000
Query: 96000:128000 and DB 720000:768000
Query: 96000:128000 and DB 768000:816000
Query: 96000:128000 and DB 816000:864000
Query: 96000:128000 and DB 864000:912000
Query: 96000:128000 and DB 912000:915202
Query: 128000:160000 and DB 0:48000
Query: 128000:160000 and DB 48000:96000
Query: 128000:160000 and DB 96000:144000
Query: 128000:160000 and DB 144000:192000
Query: 128000:160000 and DB 192000:240000
Query: 128000:160000 and DB 240000:288000
Query: 128000:160000 and DB 288000:336000
Query: 128000:160000 and DB 336000:384000
Query: 128000:160000 and DB 384000:432000
Query: 128000:160000 and DB 432000:480000
Query: 128000:160000 and DB 480000:528000
Query: 128000:160000 and DB 528000:576000
Query: 128000:160000 and DB 576000:624000
Query: 128000:160000 and DB 624000:672000
Query: 128000:160000 and DB 672000:720000
Query: 128000:160000 and DB 720000:768000
Query: 128000:160000 and DB 768000:816000
Query: 128000:160000 and DB 816000:864000
Query: 128000:160000 and DB 864000:912000
Query: 128000:160000 and DB 912000:915202
Query: 160000:192000 and DB 0:48000
Query: 160000:192000 and DB 48000:96000
Query: 160000:192000 and DB 96000:144000
Query: 160000:192000 and DB 144000:192000
Query: 160000:192000 and DB 192000:240000
Query: 160000:192000 and DB 240000:288000
Query: 160000:192000 and DB 288000:336000
Query: 160000:192000 and DB 336000:384000
Query: 160000:192000 and DB 384000:432000
Query: 160000:192000 and DB 432000:480000
Query: 160000:192000 and DB 480000:528000
Query: 160000:192000 and DB 528000:576000
Query: 160000:192000 and DB 576000:624000
Query: 160000:192000 and DB 624000:672000
Query: 160000:192000 and DB 672000:720000
Query: 160000:192000 and DB 720000:768000
Query: 160000:192000 and DB 768000:816000
Query: 160000:192000 and DB 816000:864000
Query: 160000:192000 and DB 864000:912000
Query: 160000:192000 and DB 912000:915202
Query: 192000:224000 and DB 0:48000
Query: 192000:224000 and DB 48000:96000
Query: 192000:224000 and DB 96000:144000
Query: 192000:224000 and DB 144000:192000
Query: 192000:224000 and DB 192000:240000
Query: 192000:224000 and DB 240000:288000
Query: 192000:224000 and DB 288000:336000
Query: 192000:224000 and DB 336000:384000
Query: 192000:224000 and DB 384000:432000
Query: 192000:224000 and DB 432000:480000
Query: 192000:224000 and DB 480000:528000
Query: 192000:224000 and DB 528000:576000
Query: 192000:224000 and DB 576000:624000
Query: 192000:224000 and DB 624000:672000
Query: 192000:224000 and DB 672000:720000
Query: 192000:224000 and DB 720000:768000
Query: 192000:224000 and DB 768000:816000
Query: 192000:224000 and DB 816000:864000
Query: 192000:224000 and DB 864000:912000
Query: 192000:224000 and DB 912000:915202
Query: 224000:256000 and DB 0:48000
Query: 224000:256000 and DB 48000:96000
Query: 224000:256000 and DB 96000:144000
Query: 224000:256000 and DB 144000:192000
Query: 224000:256000 and DB 192000:240000
Query: 224000:256000 and DB 240000:288000
Query: 224000:256000 and DB 288000:336000
Query: 224000:256000 and DB 336000:384000
Query: 224000:256000 and DB 384000:432000
Query: 224000:256000 and DB 432000:480000
Query: 224000:256000 and DB 480000:528000
Query: 224000:256000 and DB 528000:576000
Query: 224000:256000 and DB 576000:624000
Query: 224000:256000 and DB 624000:672000
Query: 224000:256000 and DB 672000:720000
Query: 224000:256000 and DB 720000:768000
Query: 224000:256000 and DB 768000:816000
Query: 224000:256000 and DB 816000:864000
Query: 224000:256000 and DB 864000:912000
Query: 224000:256000 and DB 912000:915202
Query: 256000:288000 and DB 0:48000
Query: 256000:288000 and DB 48000:96000
Query: 256000:288000 and DB 96000:144000
Query: 256000:288000 and DB 144000:192000
Query: 256000:288000 and DB 192000:240000
Query: 256000:288000 and DB 240000:288000
Query: 256000:288000 and DB 288000:336000
Query: 256000:288000 and DB 336000:384000
Query: 256000:288000 and DB 384000:432000
Query: 256000:288000 and DB 432000:480000
Query: 256000:288000 and DB 480000:528000
Query: 256000:288000 and DB 528000:576000
Query: 256000:288000 and DB 576000:624000
Query: 256000:288000 and DB 624000:672000
Query: 256000:288000 and DB 672000:720000
Query: 256000:288000 and DB 720000:768000
Query: 256000:288000 and DB 768000:816000
Query: 256000:288000 and DB 816000:864000
Query: 256000:288000 and DB 864000:912000
Query: 256000:288000 and DB 912000:915202
Query: 288000:320000 and DB 0:48000
Query: 288000:320000 and DB 48000:96000
Query: 288000:320000 and DB 96000:144000
Query: 288000:320000 and DB 144000:192000
Query: 288000:320000 and DB 192000:240000
Query: 288000:320000 and DB 240000:288000
Query: 288000:320000 and DB 288000:336000
Query: 288000:320000 and DB 336000:384000
Query: 288000:320000 and DB 384000:432000
Query: 288000:320000 and DB 432000:480000
Query: 288000:320000 and DB 480000:528000
Query: 288000:320000 and DB 528000:576000
Query: 288000:320000 and DB 576000:624000
Query: 288000:320000 and DB 624000:672000
Query: 288000:320000 and DB 672000:720000
Query: 288000:320000 and DB 720000:768000
Query: 288000:320000 and DB 768000:816000
Query: 288000:320000 and DB 816000:864000
Query: 288000:320000 and DB 864000:912000
Query: 288000:320000 and DB 912000:915202
Query: 320000:352000 and DB 0:48000
Query: 320000:352000 and DB 48000:96000
Query: 320000:352000 and DB 96000:144000
Query: 320000:352000 and DB 144000:192000
Query: 320000:352000 and DB 192000:240000
Query: 320000:352000 and DB 240000:288000
Query: 320000:352000 and DB 288000:336000
Query: 320000:352000 and DB 336000:384000
Query: 320000:352000 and DB 384000:432000
Query: 320000:352000 and DB 432000:480000
Query: 320000:352000 and DB 480000:528000
Query: 320000:352000 and DB 528000:576000
Query: 320000:352000 and DB 576000:624000
Query: 320000:352000 and DB 624000:672000
Query: 320000:352000 and DB 672000:720000
Query: 320000:352000 and DB 720000:768000
Query: 320000:352000 and DB 768000:816000
Query: 320000:352000 and DB 816000:864000
Query: 320000:352000 and DB 864000:912000
Query: 320000:352000 and DB 912000:915202
Query: 352000:384000 and DB 0:48000
Query: 352000:384000 and DB 48000:96000
Query: 352000:384000 and DB 96000:144000
Query: 352000:384000 and DB 144000:192000
Query: 352000:384000 and DB 192000:240000
Query: 352000:384000 and DB 240000:288000
Query: 352000:384000 and DB 288000:336000
Query: 352000:384000 and DB 336000:384000
Query: 352000:384000 and DB 384000:432000
Query: 352000:384000 and DB 432000:480000
Query: 352000:384000 and DB 480000:528000
Query: 352000:384000 and DB 528000:576000
Query: 352000:384000 and DB 576000:624000
Query: 352000:384000 and DB 624000:672000
Query: 352000:384000 and DB 672000:720000
Query: 352000:384000 and DB 720000:768000
Query: 352000:384000 and DB 768000:816000
Query: 352000:384000 and DB 816000:864000
Query: 352000:384000 and DB 864000:912000
Query: 352000:384000 and DB 912000:915202
Query: 384000:416000 and DB 0:48000
Query: 384000:416000 and DB 48000:96000
Query: 384000:416000 and DB 96000:144000
Query: 384000:416000 and DB 144000:192000
Query: 384000:416000 and DB 192000:240000
Query: 384000:416000 and DB 240000:288000
Query: 384000:416000 and DB 288000:336000
Query: 384000:416000 and DB 336000:384000
Query: 384000:416000 and DB 384000:432000
Query: 384000:416000 and DB 432000:480000
Query: 384000:416000 and DB 480000:528000
Query: 384000:416000 and DB 528000:576000
Query: 384000:416000 and DB 576000:624000
Query: 384000:416000 and DB 624000:672000
Query: 384000:416000 and DB 672000:720000
Query: 384000:416000 and DB 720000:768000
Query: 384000:416000 and DB 768000:816000
Query: 384000:416000 and DB 816000:864000
Query: 384000:416000 and DB 864000:912000
Query: 384000:416000 and DB 912000:915202
Query: 416000:448000 and DB 0:48000
Query: 416000:448000 and DB 48000:96000
Query: 416000:448000 and DB 96000:144000
Query: 416000:448000 and DB 144000:192000
Query: 416000:448000 and DB 192000:240000
Query: 416000:448000 and DB 240000:288000
Query: 416000:448000 and DB 288000:336000
Query: 416000:448000 and DB 336000:384000
Query: 416000:448000 and DB 384000:432000
Query: 416000:448000 and DB 432000:480000
Query: 416000:448000 and DB 480000:528000
Query: 416000:448000 and DB 528000:576000
Query: 416000:448000 and DB 576000:624000
Query: 416000:448000 and DB 624000:672000
Query: 416000:448000 and DB 672000:720000
Query: 416000:448000 and DB 720000:768000
Query: 416000:448000 and DB 768000:816000
Query: 416000:448000 and DB 816000:864000
Query: 416000:448000 and DB 864000:912000
Query: 416000:448000 and DB 912000:915202
Query: 448000:480000 and DB 0:48000
Query: 448000:480000 and DB 48000:96000
Query: 448000:480000 and DB 96000:144000
Query: 448000:480000 and DB 144000:192000
Query: 448000:480000 and DB 192000:240000
Query: 448000:480000 and DB 240000:288000
Query: 448000:480000 and DB 288000:336000
Query: 448000:480000 and DB 336000:384000
Query: 448000:480000 and DB 384000:432000
Query: 448000:480000 and DB 432000:480000
Query: 448000:480000 and DB 480000:528000
Query: 448000:480000 and DB 528000:576000
Query: 448000:480000 and DB 576000:624000
Query: 448000:480000 and DB 624000:672000
Query: 448000:480000 and DB 672000:720000
Query: 448000:480000 and DB 720000:768000
Query: 448000:480000 and DB 768000:816000
Query: 448000:480000 and DB 816000:864000
Query: 448000:480000 and DB 864000:912000
Query: 448000:480000 and DB 912000:915202
Query: 480000:502704 and DB 0:48000
Query: 480000:502704 and DB 48000:96000
Query: 480000:502704 and DB 96000:144000
Query: 480000:502704 and DB 144000:192000
Query: 480000:502704 and DB 192000:240000
Query: 480000:502704 and DB 240000:288000
Query: 480000:502704 and DB 288000:336000
Query: 480000:502704 and DB 336000:384000
Query: 480000:502704 and DB 384000:432000
Query: 480000:502704 and DB 432000:480000
Query: 480000:502704 and DB 480000:528000
Query: 480000:502704 and DB 528000:576000
Query: 480000:502704 and DB 576000:624000
Query: 480000:502704 and DB 624000:672000
Query: 480000:502704 and DB 672000:720000
Query: 480000:502704 and DB 720000:768000
Query: 480000:502704 and DB 768000:816000
Query: 480000:502704 and DB 816000:864000
Query: 480000:502704 and DB 864000:912000
Query: 480000:502704 and DB 912000:915202
dataset.q_val = 22168, dataset.db_val = 37742, dataset.val_pos = 22168
Loading centroids from /home/leo/usman_ws/codes/OpenIBL/examples/../logs/vgg16_pitts_64_desc_cen.hdf5
===> Start extracting features for sorting gallery
>>> >>> 1000
>>> >>> 500260
>>> 